<!doctype html>
<html lang="en" data-vocs>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="/initializeTheme.iife.js"></script><link rel="preload" as="image" href="/images/jincubator.png"/><link rel="preload" as="image" href="/assets/posts/2023-02-05-ethereum-bridging-costs/eth2NearFundsTransfer.jpg"/><title>Near Rainbow Bridge – John Whitton</title><link rel="icon" href="/images/jincubator.png" type="image/png"/><meta property="og:type" content="website"/><meta property="og:title" content="Near Rainbow Bridge"/><meta property="og:image" content="https://vocs.dev/api/og?logo=/images/jincubator.png&title=Near Rainbow Bridge&description="/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:image" content="https://vocs.dev/api/og?logo=/images/jincubator.png&title=Near%20Rainbow%20Bridge&description=undefined"/>
    <script type="module" crossorigin src="/assets/index-D3OdXp73.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/style-Cs3UkTB6.css">
  </head>
  <body>
    <div id="app"><div class="vocs_DocsLayout" data-layout="docs"><a class="vocs_SkipLink vocs_utils_visuallyHidden" href="/research/bridge/near-rainbow#vocs-content">Skip to content</a><div class="vocs_DocsLayout_gutterLeft"><aside class="vocs_Sidebar vocs_DocsLayout_sidebar"><div><div class="vocs_Sidebar_logoWrapper"><div class="vocs_Sidebar_logo"><a style="align-items:center;display:flex;height:100%" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/images/jincubator.png"/></a></div><div class="vocs_Sidebar_divider"></div></div><nav class="vocs_Sidebar_navigation"><div class="vocs_Sidebar_group"><section class="vocs_Sidebar_section"><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/intro" variant="styleless" data-discover="true">John&#x27;s Research</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Solving and Arbitrage</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/intro" variant="styleless" data-discover="true">Solving and Arbitrage Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/architecture" variant="styleless" data-discover="true">Reference Architecture</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/hooks" variant="styleless" data-discover="true">Uniswap V4 Hooks</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Primitives</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/intro" variant="styleless" data-discover="true">Primitives Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/fraud-proofs" variant="styleless" data-discover="true">Fraud Proofs</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/light-clients" variant="styleless" data-discover="true">Light Clients</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/primitives" variant="styleless" data-discover="true">Cryptogaphic Primitives</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/weak-subjectivity" variant="styleless" data-discover="true">Weak Subjectivity</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/signatures" variant="styleless" data-discover="true">Signature Schemes</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Zero Knowledge</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/intro" variant="styleless" data-discover="true">Zero Knowledge Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/zkpos" variant="styleless" data-discover="true">ZK Proof of Stake</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/zksnarks" variant="styleless" data-discover="true">zk-Snarks</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/axiom" variant="styleless" data-discover="true">Axiom</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Cross Chain Bridges</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/intro" variant="styleless" data-discover="true">Bridging Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/cosmos-ibc" variant="styleless" data-discover="true">Cosmos IBC</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/harmony-horizon" variant="styleless" data-discover="true">Harmony Horizon</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/isomorph" variant="styleless" data-discover="true">Isomorph</a><a data-active="true" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/near-rainbow" variant="styleless" data-discover="true">Near Rainbow Bridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/polymerlabs" variant="styleless" data-discover="true">Polymer Labs</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/snowbridge" variant="styleless" data-discover="true">Snowbridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/succinct" variant="styleless" data-discover="true">Succint</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Layer 1 Platforms</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/intro" variant="styleless" data-discover="true">Layer 1 Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/avalanche" variant="styleless" data-discover="true">Avalanche</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/binance" variant="styleless" data-discover="true">Binance Smart Chain</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/cosmos" variant="styleless" data-discover="true">Cosmos</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/ethereum-1-0" variant="styleless" data-discover="true">Ethereum 1.0</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/ethereum" variant="styleless" data-discover="true">Ethereum</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/NEAR" variant="styleless" data-discover="true">NEAR</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/harmony" variant="styleless" data-discover="true">Harmony</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/polkadot" variant="styleless" data-discover="true">Polkadot</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/polygon" variant="styleless" data-discover="true">Polygon</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Code Reviews</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/intro" variant="styleless" data-discover="true">Code Review Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/horizon" variant="styleless" data-discover="true">Horizon Bridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/ethereum-near" variant="styleless" data-discover="true">Ethereum Near Bridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/ethereum" variant="styleless" data-discover="true">Ethereum</a></div></section></div></nav></div><div class="vocs_Sidebar_footer"><div class="vocs_Sidebar_footerCurtain"></div><div class="vocs_Sidebar_footerContent"><div class="vocs_Socials"><a class="vocs_Socials_button" href="https://github.com/johnwhitton" target="_blank" rel="noopener noreferrer"><div aria-label="GitHub" class="vocs_Icon vocs_Socials_icon" role="img" style="--vocs_Icon_size:17px"><svg width="100%" height="100%" viewBox="0 0 98 96" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z" fill="currentColor"></path></svg></div></a><div style="width:1px;margin-top:var(--vocs-space_4);margin-bottom:var(--vocs-space_4);background-color:var(--vocs-color_border)"></div><a class="vocs_Socials_button" href="https://twitter.com/johnwhitton" target="_blank" rel="noopener noreferrer"><div aria-label="X (Twitter)" class="vocs_Icon vocs_Socials_icon" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg"><title>X</title><path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="currentColor"></path></svg></div></a><div style="width:1px;margin-top:var(--vocs-space_4);margin-bottom:var(--vocs-space_4);background-color:var(--vocs-color_border)"></div><a class="vocs_Socials_button" href="https://t.me/john_whitton" target="_blank" rel="noopener noreferrer"><div aria-label="Telegram" class="vocs_Icon vocs_Socials_icon" role="img" style="--vocs_Icon_size:17px"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 50 50"><title>Telegram</title><path d="M25 2c12.703 0 23 10.297 23 23S37.703 48 25 48 2 37.703 2 25 12.297 2 25 2zm7.934 32.375c.423-1.298 2.405-14.234 2.65-16.783.074-.772-.17-1.285-.648-1.514-.578-.278-1.434-.139-2.427.219-1.362.491-18.774 7.884-19.78 8.312-.954.405-1.856.847-1.856 1.487 0 .45.267.703 1.003.966.766.273 2.695.858 3.834 1.172 1.097.303 2.346.04 3.046-.395.742-.461 9.305-6.191 9.92-6.693.614-.502 1.104.141.602.644-.502.502-6.38 6.207-7.155 6.997-.941.959-.273 1.953.358 2.351.721.454 5.906 3.932 6.687 4.49.781.558 1.573.811 2.298.811.725 0 1.107-.955 1.468-2.064z" fill="currentColor"></path></svg></div></a></div></div></div></aside></div><div class="vocs_DocsLayout_gutterTop vocs_DocsLayout_gutterTop_offsetLeftGutter"><div class="vocs_DesktopTopNav"><button class="vocs_DesktopSearch_search" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«Rlj»" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-top:2px"><path d="M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>Search...<div class="vocs_DesktopSearch_searchCommand"><div style="background:currentColor;transform:rotate(45deg);width:1.5px;border-radius:2px;height:100%"></div></div></button><div class="vocs_DesktopTopNav_logoWrapper"><div class="vocs_DesktopTopNav_logo"><a style="align-items:center;display:flex;height:56px;margin-top:4px" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/images/jincubator.png"/></a></div></div><div class="vocs_DesktopTopNav_section"></div><div class="vocs_DesktopTopNav_section"><div class="vocs_DesktopTopNav_group"><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="vocs_NavigationMenu"><div style="position:relative"><ul data-orientation="horizontal" class="vocs_NavigationMenu_list" dir="ltr"><a data-active="true" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/" variant="styleless" data-radix-collection-item="" data-discover="true">Home</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/about" variant="styleless" data-radix-collection-item="" data-discover="true">About John</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/resume" variant="styleless" data-radix-collection-item="" data-discover="true">Resume</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/references/intro" variant="styleless" data-radix-collection-item="" data-discover="true">References</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/writing/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Writing</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/research/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Research</a></ul></div></nav></div></div></div><div class="vocs_MobileTopNav"><div class="vocs_MobileTopNav_section"><div class="vocs_MobileTopNav_group"><div class="vocs_MobileTopNav_logo"><a style="align-items:center;display:flex;height:100%" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/images/jincubator.png"/></a></div></div><div class="vocs_MobileTopNav_group"><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="vocs_MobileTopNav_navigation vocs_NavigationMenu"><div style="position:relative"><ul data-orientation="horizontal" class="vocs_NavigationMenu_list" dir="ltr"><a data-active="true" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/" variant="styleless" data-radix-collection-item="" data-discover="true">Home</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/about" variant="styleless" data-radix-collection-item="" data-discover="true">About John</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/resume" variant="styleless" data-radix-collection-item="" data-discover="true">Resume</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/references/intro" variant="styleless" data-radix-collection-item="" data-discover="true">References</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/writing/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Writing</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/research/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Research</a></ul></div></nav><div class="vocs_MobileTopNav_navigation vocs_MobileTopNav_navigation_compact"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«Rkpj»" data-state="closed" class="vocs_MobileTopNav_menuTrigger vocs_MobileTopNav_navigationItem">Home<div aria-label="Menu" class="vocs_Icon" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Down</title><path d="M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="vocs_MobileTopNav_section"><div class="vocs_MobileTopNav_group" style="margin-right:-8px"><button class="vocs_MobileSearch_searchButton" type="button" aria-label="Search" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«R19j»" data-state="closed"><svg width="21" height="21" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div></div></div></div><div class="vocs_DocsLayout_gutterTopCurtain vocs_DocsLayout_gutterTopCurtain_withSidebar"><div class="vocs_DesktopTopNav_curtain"></div><div class="vocs_MobileTopNav_curtain"><div class="vocs_MobileTopNav_curtainGroup"><div class="vocs_MobileTopNav_curtainItem"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«Rqj»" data-state="closed" class="vocs_MobileTopNav_menuTrigger"><div aria-label="Menu" class="vocs_Icon" role="img" style="--vocs_Icon_size:13px"><svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 79 48" fill="none"><title>Menu</title><path fill="currentColor" d="M19.528 47.232h40.87c1.952 0 3.515-1.562 3.515-3.564a3.5 3.5 0 0 0-3.516-3.516H19.528a3.501 3.501 0 0 0-3.515 3.516c0 2.002 1.562 3.564 3.515 3.564ZM12.057 27.262h55.81a3.501 3.501 0 0 0 3.516-3.516 3.501 3.501 0 0 0-3.515-3.515h-55.81a3.501 3.501 0 0 0-3.516 3.515 3.501 3.501 0 0 0 3.515 3.516ZM4.391 7.34H75.29c2.002 0 3.515-1.563 3.515-3.516 0-2.002-1.513-3.564-3.515-3.564H4.39C2.438.26.876 1.822.876 3.824A3.501 3.501 0 0 0 4.39 7.34Z"></path></svg></div><div class="vocs_MobileTopNav_menuTitle">Near Rainbow Bridge</div></button></div></div><div class="vocs_MobileTopNav_curtainGroup"><div class="vocs_MobileTopNav_curtainItem"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«R5aj»" data-state="closed" class="vocs_MobileTopNav_outlineTrigger">On this page<div aria-label="On this page" class="vocs_Icon" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Right</title><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button></div></div></div></div><div class="vocs_DocsLayout_gutterRight vocs_DocsLayout_gutterRight_withSidebar"></div><div id="vocs-content" class="vocs_DocsLayout_content vocs_DocsLayout_content_withSidebar vocs_DocsLayout_content_withTopNav"><article class="vocs_Content"><header class="vocs_Header"><h1 class="vocs_H1 vocs_Heading"><div id="near-rainbow-bridge" class="vocs_Heading_slugTarget"></div>Near Rainbow Bridge<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#near-rainbow-bridge" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h1></header>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">date: 2023-02-24</li>
<li class="vocs_ListItem">last updated: 2023-02-24</li>
</ul>
<h2 class="vocs_H2 vocs_Heading"><div id="overview" class="vocs_Heading_slugTarget"></div>Overview<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#overview" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">NEAR Rainbow bridge was enhanced to support Ethereum 2.0 leveraging Ethereum Light Clients. This document is a review of the design.</p>
<p class="vocs_Paragraph">Key differences in supporting Ethereum 2.0 (Proof of Stake) vs Proof of Work involves removing the ETHHASH logic and SPV client and potentially replacing with MMR trees per epoch and checkpoints similar to Harmony Light Client on Ethereum.</p>
<p class="vocs_Paragraph">The <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://near.org/bridge/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NEAR Rainbow bridge</a> is in <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">this github repository</a> and is supported by <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Aurora-labs</a>.</p>
<p class="vocs_Paragraph">It recently provided support for ETH 2.0 in this <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/pull/762" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Pull Request (762)</a>.</p>
<p class="vocs_Paragraph">It interacts <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">lighthouse</a> for Ethereum 2.0 Consensus and tree_hash functions as well as bls signatures.</p>
<p class="vocs_Paragraph">High Level their architecture is similar to the Horizon Bridge but with some key differences, including but not limited to</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">interacting with the beacon chain now for finality <code class="vocs_Code">is_correct_finality_update</code> <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/finality-update-verify/src/lib.rs#L36" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">see finality-update-verify</a></li>
<li class="vocs_ListItem">Updated execution block proof to use the BEACONRPCClient and with an updated merkle tree<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Design can be found in <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/pull/762" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">PR-762</a></li>
</ul>
</li>
</ul>
<h2 class="vocs_H2 vocs_Heading"><div id="approach" class="vocs_Heading_slugTarget"></div>Approach<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#approach" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">Near Rainbow bridge uses a fradu proof approach.</p>
<h2 class="vocs_H2 vocs_Heading"><div id="proving-mechanisms" class="vocs_Heading_slugTarget"></div>Proving Mechanisms<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#proving-mechanisms" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="near-to-ethereum-watchdog" class="vocs_Heading_slugTarget"></div>NEAR to Ethereum watchdog<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#near-to-ethereum-watchdog" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/near2eth/watchdog/index.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">watchdog</a> runs every 10 seconds and validates blocks on <code class="vocs_Code">NearBridge.sol</code> challenging blocks with incorrect signatures. <em>Note: It uses <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/utils/http-prometheus.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">heep-prometheus</a> for monitoring and storing block and producer information using <code class="vocs_Code">gauges</code> and <code class="vocs_Code">counters</code>.</em></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/cli/commands/start/watchdog.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">watchdog is started</a> from the CLI</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/near2eth/watchdog/index.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">watchdog logic</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Initializes monitoring information on <code class="vocs_Code">Prometheus</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">const httpPrometheus = new HttpPrometheus(this.metricsPort, &#x27;near_bridge_watchdog_&#x27;)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">const lastBlockVerified = httpPrometheus.gauge(&#x27;last_block_verified&#x27;, &#x27;last block that was already verified&#x27;)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">const totBlockProducers = httpPrometheus.gauge(&#x27;block_producers&#x27;, &#x27;number of block producers for current block&#x27;)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">const incorrectBlocks = httpPrometheus.counter(&#x27;incorrect_blocks&#x27;, &#x27;number of incorrect blocks found&#x27;)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">const challengesSubmitted = httpPrometheus.counter(&#x27;challenges_submitted&#x27;, &#x27;number of blocks challenged&#x27;)</code></li>
</ul>
</li>
<li class="vocs_ListItem">Loops <code class="vocs_Code">while (true)</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Gets the <code class="vocs_Code">bridgeState</code></li>
<li class="vocs_ListItem">Loops through all blockProducers checking their signatures</li>
<li class="vocs_ListItem"><code class="vocs_Code">for (let i = 0; i &lt; numBlockProducers; i++)</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Check each signature <code class="vocs_Code">this.clientContract.methods.checkBlockProducerSignatureInHead(i).call()</code></li>
<li class="vocs_ListItem">If invalid challenge the signature: <code class="vocs_Code">this.clientContract.methods.challenge(this.ethMasterAccount, i).encodeABI()</code> calls <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/NearBridge.sol#L93" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">challenge function</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">function challenge(address payable receiver, uint signatureIndex) external override pausable(PAUSED_CHALLENGE)</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">checks block.timestamp is less than lastValidAt <code class="vocs_Code">block.timestamp &lt; lastValidAt,</code></li>
<li class="vocs_ListItem">Check if the signature is valid <code class="vocs_Code">!checkBlockProducerSignatureInHead(signatureIndex)</code></li>
<li class="vocs_ListItem">slashes the last submitter <code class="vocs_Code">balanceOf[lastSubmitter] = balanceOf[lastSubmitter] - lockEthAmount;</code></li>
<li class="vocs_ListItem">resets lastValidAt <code class="vocs_Code">lastValidAt = 0;</code></li>
<li class="vocs_ListItem">Refunds half of the funds to the watchdog account <code class="vocs_Code">receiver.call{value: lockEthAmount / 2}(&quot;&quot;);</code></li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem">Sleeps for watchdog Delay seconds <code class="vocs_Code">await sleep(watchdogDelay * 1000)</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="vocs_H2 vocs_Heading"><div id="relayer-mechanisms" class="vocs_Heading_slugTarget"></div>Relayer Mechanisms<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#relayer-mechanisms" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="ethereum-to-near-block-propagation-flow" class="vocs_Heading_slugTarget"></div>Ethereum to NEAR block propagation flow<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#ethereum-to-near-block-propagation-flow" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Following is a walkthough of block propogation from Ethereum to NEAR. For a better understanding of the technical components see <a class="vocs_Anchor" href="/research/bridge/near-rainbow#appendix-a-ethereum-to-near-block-propagation-components">Appendix A</a>.</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/main.rs#L107" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Light Clients are deployed on Near</a>:<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/main.rs#L107" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">init_contract</a>: The eth2near relayer is called with an argument to initialize the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth2-client/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2-client contract</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/main.rs#L108" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth_client_contract</a>: is created using a contract_wrapper<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">let mut eth_client_contract = EthClientContract::new(get_eth_contract_wrapper(&amp;config));</code></li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/contract_wrapper/src/eth_client_contract.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">EthClientContract Wrapper</a>: creates an instance of <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth2-client/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2-client contract</a> with the following arguments<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">network</code> - the name of Ethereum network such as <code class="vocs_Code">mainnet</code>, <code class="vocs_Code">goerli</code>, <code class="vocs_Code">kiln</code>, etc.</li>
<li class="vocs_ListItem"><code class="vocs_Code">finalized_execution_header</code> - the finalized execution header to start initialization with.</li>
<li class="vocs_ListItem"><code class="vocs_Code">finalized_beacon_header</code> - correspondent finalized beacon header.</li>
<li class="vocs_ListItem"><code class="vocs_Code">current_sync_committee</code> - sync committee correspondent for finalized block.</li>
<li class="vocs_ListItem"><code class="vocs_Code">next_sync_committee</code> - sync committee for the next period after period for finalized block.</li>
<li class="vocs_ListItem"><code class="vocs_Code">hashes_gs_threshold</code> - the maximum number of stored finalized blocks.</li>
<li class="vocs_ListItem"><code class="vocs_Code">max_submitted_block_by_account</code> - the maximum number of unfinalized blocks which one relay can store in the client&#x27;s storage.</li>
<li class="vocs_ListItem"><code class="vocs_Code">trusted_signer</code> - the account address of the trusted signer which is allowed to submit light client updates.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/main.rs#L111" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Relayer is Created</a>:<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/main.rs#L111" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2near_relay</a> is created using the following arguments<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">let mut eth2near_relay = Eth2NearRelay::init(&amp;config, get_eth_client_contract(&amp;config), args.enable_binary_search, args.submit_only_finalized_blocks,);</code></li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/main.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Relayer is Started</a>:<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">The relayer is started using <code class="vocs_Code">eth2near_relay.run(None);</code></li>
<li class="vocs_ListItem">This executes the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/eth2near_relay.rs#L257" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2near_relay run function</a> <code class="vocs_Code">pub fn run(&amp;mut self, max_iterations: Option&lt;u64&gt;)</code> which runs until terminated doing using the following loop <code class="vocs_Code">while !self.terminate</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">self.wait_for_synchronization(),</code>: gets the sync status</li>
<li class="vocs_ListItem"><code class="vocs_Code">sleep(Duration::from_secs(12));</code>: waits for 12 seconds</li>
<li class="vocs_ListItem"><code class="vocs_Code">self.get_max_slot_for_submission()</code>: gets the maximum slot for submission from Ethereum</li>
<li class="vocs_ListItem"><code class="vocs_Code">self.get_last_eth2_slot_on_near</code>: gets the latest slot propogated from Ethereum to NEAR</li>
<li class="vocs_ListItem"><code class="vocs_Code">if last_eth2_slot_on_near &lt; max_slot_for_submission</code>: If there are slots to process<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">self.get_execution_blocks_between(last_eth2_slot_on_near + 1, max_slot_for_submission,),</code>: Get the execution blocks to be processed</li>
<li class="vocs_ListItem"><code class="vocs_Code">self.submit_execution_blocks(headers, current_slot, &amp;mut last_eth2_slot_on_near)</code>: submit them</li>
<li class="vocs_ListItem"><code class="vocs_Code">were_submission_on_iter = true;</code>: flags that there were submissions</li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">were_submission_on_iter |= self.send_light_client_updates_with_checks(last_eth2_slot_on_near);</code>: send light_client updates with checks and updates the submission flag to true if if passes. Following is some key logic<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">self.is_enough_blocks_for_light_client_update</code>: Checks if there are enough blocks for a light client update<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">self.send_light_client_updates</code> calls <code class="vocs_Code">send_light_client_update</code> which<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">if last_finalized_slot_on_eth &gt;= last_finalized_slot_on_near + self.max_blocks_for_finalization</code>: checks if the gap is too big (i.e. we are at a new slot) between slot of finalized block on NEAR and ETH. If it is it sends a hand made client update (which will loop getting the new slots sync committees) otherwise it sends a regular client update (which propogates the block headers)<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">self.send_hand_made_light_client_update(last_finalized_slot_on_near);</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">let include_next_sync_committee = BeaconRPCClient::get_period_for_slot (last_finalized_slot_on_near) != BeaconRPCClient::get_period_for_slot(attested_slot);</code></li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">self.send_regular_light_client_update(last_finalized_slot_on_eth, last_finalized_slot_on_near,);</code></li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">self.send_specific_light_client_update(light_client_update)</code> is called for both regular and hand made updates.<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">self.eth_client_contract.is_known_block</code>: Checks if the block is already known on the Etherum Client Contract on NEAR</li>
<li class="vocs_ListItem"><code class="vocs_Code">self.verify_bls_signature_for_finality_update(&amp;light_client_update)</code>: Verifies the BLS signatures. This calls <code class="vocs_Code">is_correct_finality_update</code> in <code class="vocs_Code">eth2near/finality-update-verify/src/lib.rs</code> *</li>
<li class="vocs_ListItem"><code class="vocs_Code">self.eth_client_contract.send_light_client_update(light_client_update.clone())</code>: Updates the light client with the finalized block</li>
<li class="vocs_ListItem"><code class="vocs_Code">self.beacon_rpc_client.get_block_number_for_slot(types::Slot::new(light_client_update.finality_update.header_update.beacon_header.slot.as_u64())),</code>: Validates Finalized block number is correct on Ethereum usng the <code class="vocs_Code">beacon_rpc_client</code>.</li>
<li class="vocs_ListItem"><code class="vocs_Code">sleep(Duration::from_secs(self.sleep_time_after_submission_secs));</code>: sleeps for the configured submission sleep time.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">if !were_submission_on_iter {thread::sleep(Duration::from_secs(self.sleep_time_on_sync_secs));}</code>: if there were submissions sleep for however many seconds were configured for sync sleep time.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="near-to-ethereum-block-propagation-flow" class="vocs_Heading_slugTarget"></div>NEAR to Ethereum block propagation flow<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#near-to-ethereum-block-propagation-flow" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nomicon.io/ChainSpec/LightClient" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NEAR Light Client Documentation</a> gives an overview of how light clients work. At a high level the light client needs to fetch at least one block per <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.near.org/concepts/basics/epoch" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">epoch</a> i.e. every 42,200 blocks or approxmiately 12 hours. Also Having the LightClientBlockView for block B is sufficient to be able to verify any statement about state or outcomes in any block in the ancestry of B (including B itself).</p>
<p class="vocs_Paragraph">The current scripts and codebase indicates that a block would be fetched every 30 seconds with a max delay of 10 seconds. It feels that this would be expensive to update Ethereum so frequently. <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://near.org/bridge/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NEAR&#x27;s bridge documentation</a> states <em>Sending assets from NEAR back to Ethereum currently takes a maximum of sixteen hours (due to Ethereum finality times)</em>. This seems to align with sending light client updates once per NEAR epoch. The block fetch period is configurable in the relayer.</p>
<blockquote class="vocs_Blockquote">
<p class="vocs_Paragraph">The RPC returns the LightClientBlock for the block as far into the future from the last known hash as possible for the light client to still accept it. Specifically, it either returns the last final block of the next epoch, or the last final known block. If there&#x27;s no newer final block than the one the light client knows about, the RPC returns an empty result.</p>
<p class="vocs_Paragraph">A standalone light client would bootstrap by requesting next blocks until it receives an empty result, and then periodically request the next light client block.</p>
<p class="vocs_Paragraph">A smart contract-based light client that enables a bridge to NEAR on a different blockchain naturally cannot request blocks itself. Instead external oracles query the next light client block from one of the full nodes, and submit it to the light client smart contract. The smart contract-based light client performs the same checks described above, so the oracle doesn&#x27;t need to be trusted.</p>
</blockquote>
<p class="vocs_Paragraph">Block Submitters stake ETH to be allowed to submit blocks which get&#x27;s slashed if the watchdog identifies blocks with invalid signatures.</p>
<p class="vocs_Paragraph"><em>Note: Have not identified how the block submitters are rewarded for submitting blocks. Currently have only identified them locking ETH to be able to submit blocks and being slashed if they submit blocks with invalid signatures.</em></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/cli/index.js#L518" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Light Clients are deployed on Ethereum</a> via the CLI using <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/cli/init/eth-contracts.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth-contracts.js</a></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/cli/index.js#L505" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">init-eth-ed25519</a>: Deploys <code class="vocs_Code">Ed25519.sol</code> see more information under <a class="vocs_Anchor" href="/research/bridge/near-rainbow#nearbridge-cryptographic-primitives">nearbridge Cryptographic Primitives</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/cli/index.js#L520" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">init-eth-client</a>: Deploys <code class="vocs_Code">NearBridge.sol</code> see more information under <a class="vocs_Anchor" href="/research/bridge/near-rainbow#near-to-ethereum-block-propagation-components">NEAR to Ethereum block propagation components</a>. It takes the following arguments<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">ethEd25519Address</code>: The address of the ECDSA signature checker using Ed25519 curve (see <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nbeguier.medium.com/a-real-world-comparison-of-the-ssh-key-algorithms-b26b0b31bfd9" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a>)</li>
<li class="vocs_ListItem"><code class="vocs_Code">lockEthAmount</code>: The amount that <code class="vocs_Code">BLOCK_PRODUCERS</code> need to deposit (in wei)to be able to provide blocks. This amount will be slashed if the block is challenged and proven not to have a valid signature. Default value is 100000000000000000000 WEI = 100 ETH.</li>
<li class="vocs_ListItem"><code class="vocs_Code">lockDuration</code> : 30 seconds</li>
<li class="vocs_ListItem"><code class="vocs_Code">replaceDuration</code>: 60 seconds it is passed in nanoseconds, because it is a difference between NEAR timestamps.</li>
<li class="vocs_ListItem"><code class="vocs_Code">ethAdminAddress</code>: Bridge Administrator Address</li>
<li class="vocs_ListItem"><code class="vocs_Code">0</code> : Indicates nothing is paused <code class="vocs_Code">UNPAUSE_ALL</code></li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/cli/index.js#L538" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">init-eth-prover</a>: Deploys <code class="vocs_Code">NearProver.sol</code> see more information under <a class="vocs_Anchor" href="/research/bridge/near-rainbow#near-to-ethereum-block-propagation-components">NEAR to Ethereum block propagation components</a>. It takes the following arguments<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">ethClientAddress</code>: Interface to <code class="vocs_Code">NearBridge.sol</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">ethAdminAddress</code>: Administrator address</li>
<li class="vocs_ListItem"><code class="vocs_Code">0</code>: paused indicator defaults to <code class="vocs_Code">UNPAUSE_ALL = 0</code></li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/cli/commands/start/near2eth-relay.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Relayer is Started</a></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Relayer is started using the following command</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">cli/index.js start near2eth-relay \</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">--eth-node-url http://127.0.0.1:8545/ \</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">--eth-master-sk 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 \</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">--near-node-url https://rpc.testnet.near.org/ \</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">--near-network-id testnet \</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">--eth-client-address 0xe7f1725e7734ce288f8367e1bb143e90bb3f0512 \</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">--eth-use-eip-1559 true \</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">--near2eth-relay-max-delay 10 \</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">--near2eth-relay-block-select-duration 30 \</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">--near2eth-relay-after-submit-delay-ms 1000 \</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">--log-verbose true \</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">--daemon false</span></span></code></pre></div></div>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/near2eth/near2eth-block-relay/index.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Relayer Logic</a></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Loops <code class="vocs_Code">while (true)</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Get the bridge state (including <code class="vocs_Code">currentHeight</code>, <code class="vocs_Code">nextTimestamp</code>, <code class="vocs_Code">nextValidAt</code>, <code class="vocs_Code">numBlockProducers</code> )</li>
<li class="vocs_ListItem">Get the <code class="vocs_Code">currentBlockHash</code> the hash of the current untrursted block based on <code class="vocs_Code">lastValidAt</code></li>
<li class="vocs_ListItem">Gets the <code class="vocs_Code">lastBlock</code> by calling the NEAR rpc <code class="vocs_Code">next_light_client_block</code> using the hash of last untrusted block <code class="vocs_Code">bs58.encode(currentBlockHash)</code></li>
<li class="vocs_ListItem">Get&#x27;s the <code class="vocs_Code">replaceDuration</code> by <code class="vocs_Code">clientContract.methods.replaceDuration().call()</code> this will be 60 seconds if we deployed <code class="vocs_Code">NearBridge.sol</code> with the default values above</li>
<li class="vocs_ListItem">Sets <code class="vocs_Code">nextValidAt</code> from the bridge state <code class="vocs_Code">web3.utils.toBN(bridgeState.nextValidAt)</code></li>
<li class="vocs_ListItem">Sets <code class="vocs_Code">replaceDelay</code> to 0 then updates it to the <code class="vocs_Code">nextTimestamp</code> + <code class="vocs_Code">replaceDuration</code> - <code class="vocs_Code">lastBlock.inner_lite.timestamp</code> i.e. The new block has to be at least 60 seconds after the current block stored on the light client.</li>
<li class="vocs_ListItem">Checks the height of the <code class="vocs_Code">currentHeight</code> of the bridge is less than the <code class="vocs_Code">lastblock</code> from the near light client <code class="vocs_Code">(bridgeState.currentHeight &lt; lastBlock.inner_lite.height)</code></li>
<li class="vocs_ListItem">Serializes the <code class="vocs_Code">lastBlock</code> using Borsh and check that the block is suitable</li>
<li class="vocs_ListItem">Checks that the <code class="vocs_Code">replaceDelay</code> has been met, if not sleeps until it has</li>
<li class="vocs_ListItem">Checks that the Master Account (the one submitting the block) has enough locked ETH (if not tries to deposit more). So that it can be slashed if the block proposed is invalid.</li>
<li class="vocs_ListItem">Adds the light client block <code class="vocs_Code">await clientContract.methods.addLightClientBlock(nextBlockSelection.borshBlock).send</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Checks <code class="vocs_Code">NearBridge.sol</code> (the light client) has been initialized</li>
<li class="vocs_ListItem">Checks <code class="vocs_Code">balanceOf[msg.sender] &gt;= lockEthAmount</code> that the sender has locked enough Eth to allow them to submit blocks</li>
<li class="vocs_ListItem">Decodes the nearBlock using <code class="vocs_Code">Borsh.from(data)</code> and <code class="vocs_Code">borsh.decodeLightClientBlock()</code></li>
<li class="vocs_ListItem">Commis the previous block, or make sure that it is OK to replace it using<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">lastValidAt = 0;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">blockHashes_[curHeight] = untrustedHash;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">blockMerkleRoots_[curHeight] = untrustedMerkleRoot;</code></li>
</ul>
</li>
<li class="vocs_ListItem">Check that the new block&#x27;s height is greater than the current one&#x27;s. <code class="vocs_Code">nearBlock.inner_lite.height &gt; curHeight</code></li>
<li class="vocs_ListItem">Check that the new block is from the same epoch as the current one, or from the next one.</li>
<li class="vocs_ListItem">Check that the new block is signed by more than 2/3 of the validators.</li>
<li class="vocs_ListItem">If the block is from the next epoch, make sure that the Block producers <code class="vocs_Code">next_bps</code> are supplied and have a correct hash.</li>
<li class="vocs_ListItem">Add the Block to the Light client<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Updates untrusted information to this block including <code class="vocs_Code">untrustedHeight</code>, <code class="vocs_Code">untrustedTimestamp</code>, <code class="vocs_Code">untrustedHash</code>, <code class="vocs_Code">untrustedMerkleRoot</code>, <code class="vocs_Code">untrustedNextHash</code>, <code class="vocs_Code">untrustedSignatureSet</code>, <code class="vocs_Code">untrustedNextEpoch</code></li>
<li class="vocs_ListItem">If <code class="vocs_Code">fromNextEpoch</code> also update the Block Producers</li>
<li class="vocs_ListItem">Updates the <code class="vocs_Code">lastSubmitter</code> and <code class="vocs_Code">lastValidAt</code></li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem">Cleans up the selected block to prevent submitting the same block again <code class="vocs_Code">await sleep(afterSubmitDelayMs)</code></li>
<li class="vocs_ListItem">Sets the HeightGauuges to the correct block height<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">clientHeightGauge.set(Number(BigInt(bridgeState.currentHeight))</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">chainHeightGauge.set(Number(BigInt(lastBlock.inner_lite.height)))</code></li>
</ul>
</li>
<li class="vocs_ListItem">Sleeps for delay calculated from the maximum of the relayer days (10 seconds) and differnce between the current and next block time stamps and <code class="vocs_Code">await sleep(1000 * delay)</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="vocs_H2 vocs_Heading"><div id="light-client-functionality" class="vocs_Heading_slugTarget"></div>Light Client Functionality<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#light-client-functionality" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="near-rainbow-bridge-ethereum-light-client-walkthrough" class="vocs_Heading_slugTarget"></div>Near Rainbow Bridge Ethereum Light Client Walkthrough<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#near-rainbow-bridge-ethereum-light-client-walkthrough" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The following is a walkthrough of how a transaction executed on Ethereum is propogated to NEAR&#x27;s <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/near/eth2-client" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2-client</a>. See <a class="vocs_Anchor" href="/research/bridge/near-rainbow#cryptographic-primitives">Cryptographic Primitives</a> for more information on the cryptography used. and <a class="vocs_Anchor" href="/research/bridge/near-rainbow#appendix-b-ethereum-light-client-finality-update-verify-components">Appendix B</a> for verification components.</p>
<strong class="vocs_Strong">At a high level the ethereum light client contract</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Optionally accepts client updates only from a trusted client</li>
<li class="vocs_ListItem">Can pause functions</li>
<li class="vocs_ListItem">Validates a sync committee exists for the curremt slot</li>
<li class="vocs_ListItem">Validates sync committe has greater than the minimum required sync committee members</li>
<li class="vocs_ListItem">Validates 2/3 or more of the committe members have signed the blocks</li>
<li class="vocs_ListItem">Validates bls signatures (i.e. the bls signatures of the sync comittee for the blocks propogated)</li>
<li class="vocs_ListItem">Stores the hashes of the blocks for the past <code class="vocs_Code">hashes_gc_threshold</code> headers. Events that happen past this threshold cannot be verified by the client. It is desirable that this number is larger than 7 days&#x27; worth of headers, which is roughly 51k Ethereum blocks. So this number should be 51k in production.</li>
<li class="vocs_ListItem">Stores the Ethereum Network (e.g. mainnet, kiln)</li>
<li class="vocs_ListItem">Stores Hashes of the finalized execution blocks mapped to their numbers.</li>
<li class="vocs_ListItem">Stores All unfinalized execution blocks&#x27; headers hashes mapped to their <code class="vocs_Code">HeaderInfo</code>.</li>
<li class="vocs_ListItem">Stores <code class="vocs_Code">AccountId</code>s mapped to their number of submitted headers.</li>
<li class="vocs_ListItem">Stores Max number of unfinalized blocks allowed to be stored by one submitter account. This value should be at least 32 blocks (1 epoch), but the recommended value is 1024 (32 epochs)</li>
<li class="vocs_ListItem">Stores minimum balance that should be attached to register a new submitter account.</li>
<li class="vocs_ListItem">Stores finalized beacon header</li>
<li class="vocs_ListItem">Stores finalized execution header</li>
<li class="vocs_ListItem">Stores current_sync_committee</li>
<li class="vocs_ListItem">Stores next_sync_committee</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="near-rainbow-bridge-near-light-client-walkthrough" class="vocs_Heading_slugTarget"></div>Near Rainbow Bridge Near Light Client Walkthrough<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#near-rainbow-bridge-near-light-client-walkthrough" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The following is a walkthrough of how a transaction executed on NEAR is propogated to Ethereum&#x27;s <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/eth/nearbridge" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">nearbridge</a>. See <a class="vocs_Anchor" href="/research/bridge/near-rainbow#nearbridge-cryptographic-primitives">nearbridge Cryptographic Primitives</a> for more information on the cryptography used.</p>
<strong class="vocs_Strong">NearOnEthClient Overview</strong>
<p class="vocs_Paragraph"><em>The following is an excerpt from a blog by near on <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://near.org/blog/eth-near-rainbow-bridge/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth-near-rainbow-bridge</a></em></p>
<blockquote class="vocs_Blockquote">
<p class="vocs_Paragraph">NearOnEthClient is an implementation of the NEAR light client in Solidity as an Ethereum contract. Unlike EthOnNearClient it does not need to verify every single NEAR header and can skip most of them as long as it verifies at least one header per NEAR epoch, which is about 43k blocks and lasts about half a day. As a result, NearOnEthClient can memorize hashes of all submitted NEAR headers in history, so if you are making a transfer from NEAR to Ethereum and it gets interrupted you don’t need to worry and you can resume it any time, even months later. Another useful property of the NEAR light client is that every NEAR header contains a root of the merkle tree computed from all headers before it. As a result, if you have one NEAR header you can efficiently verify any event that happened in any header before it.</p>
<p class="vocs_Paragraph">Another useful property of the NEAR light client is that it only accepts final blocks, and final blocks cannot leave the canonical chain in NEAR. This means that NearOnEthClient does not need to worry about forks.</p>
<p class="vocs_Paragraph">However, unfortunately, NEAR uses <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-665.mdx" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Ed25519</a> to sign messages of the validators who approve the blocks, and this signature is not available as an EVM precompile. It makes verification of all signatures of a single NEAR header prohibitively expensive. So technically, we cannot verify one NEAR header within one contract call to NearOnEthClient. Therefore we adopt the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://medium.com/@deaneigenmann/optimistic-contracts-fb75efa7ca84" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">optimistic approach</a> where NearOnEthClient verifies everything in the NEAR header except the signatures. Then anyone can challenge a signature in a submitted header within a 4-hour challenge window. The challenge requires verification of a single Ed25519 signature which would cost about 500k Ethereum gas (expensive, but possible). The user submitting the NEAR header would have to post a bond in Ethereum tokens, and a successful challenge would burn half of the bond and return the other half to the challenger. The bond should be large enough to pay for the gas even if the gas price increases exponentially during the 4 hours. For instance, a 20 ETH bond would cover gas price hikes up to 20000 Gwei. This optimistic approach requires having a watchdog service that monitors submitted NEAR headers and challenges any headers with invalid signatures. For added security, independent users can run several watchdog services.</p>
<p class="vocs_Paragraph">Once EIP665 is accepted, Ethereum will have the Ed25519 signature available as an EVM precompile. This will make watchdog services and the 4-hour challenge window unnecessary.</p>
<p class="vocs_Paragraph">At its bare minimum, Rainbow Bridge consists of EthOnNearClient and NearOnEthClient contracts, and three services: Eth2NearRelay, Near2EthRelay, and the Watchdog. We might argue that this already constitutes a bridge since we have established a cryptographic link between two blockchains, but practically speaking it requires a large portion of additional code to make application developers even consider using the Rainbow Bridge for their applications.</p>
</blockquote>
<p class="vocs_Paragraph"><em>The following information on sending assets from NEAR back to Ethereum is an excerpt from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://near.org/bridge/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">https://near.org/bridge/</a>.</em></p>
<blockquote class="vocs_Blockquote">
<p class="vocs_Paragraph">Sending assets from NEAR back to Ethereum currently takes a maximum of sixteen hours (due to Ethereum finality times) and costs around $60 (due to ETH gas costs and at current ETH price). These costs and speeds will improve in the near future.</p>
</blockquote>
<h2 class="vocs_H2 vocs_Heading"><div id="token-lockers" class="vocs_Heading_slugTarget"></div>Token Lockers<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#token-lockers" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="token-transfer-process-flow" class="vocs_Heading_slugTarget"></div>Token Transfer Process Flow<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#token-transfer-process-flow" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://near.org/bridge/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NEAR Rainbow Bridge</a> uses ERC-20 connectors which are developed in <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">rainbow-token-connector</a> and <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge-client" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">rainbow-bridge-client</a>. Also see <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/docs/workflows/eth2near-fun-transfer.mdx" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2near-fun-transfer.md</a>.</p>
<p class="vocs_Paragraph">Following is an overview of timing and anticipated costs</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Once on NEAR, transactions will confirm in 1-2 seconds and cost well under $1 in most cases.</li>
<li class="vocs_ListItem">Since the Bridge requires transactions on Ethereum for NEAR and Ethereum, the following costs are expected.</li>
<li class="vocs_ListItem">Sending assets from Ethereum to NEAR takes about six minutes (20 blocks) and for ERC-20 costs about $10 on average.</li>
<li class="vocs_ListItem">Sending assets from NEAR back to Ethereum currently takes a maximum of sixteen hours (due to Ethereum finality times) and costs around $60 (due to ETH gas costs and at current ETH price). These costs and speeds will improve in the near future.</li>
</ul>
<p class="vocs_Paragraph"><em>Note: This uses Ethreum <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://eips.ethereum.org/EIPS/eip-20" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ERC20</a> and NEAR <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nomicon.io/Standards/Tokens/FungibleToken/Core" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NEP-141</a> initally developed for <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/near/NEPs/pull/21" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NEP-21</a></em></p>
<strong class="vocs_Strong"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/blob/master/README.mdx" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Generic ERC-20/NEP-141 connector for Rainbow Bridge</a></strong>
<strong class="vocs_Strong">Specification</strong>
<strong class="vocs_Strong">Ethereum&#x27;s side</strong>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">contract</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> ERC20Locker</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">  constructor</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> memory</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> nearTokenFactory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">INearProver</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> prover</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">public</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">  function </span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">lockToken</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(IERC20 token, uint256 amount, string memory accountId) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">public</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">  function </span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">unlockToken</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(bytes memory proofData, uint64 proofBlockHeader) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">public</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<strong class="vocs_Strong">NEAR&#x27;s side</strong>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> BridgeTokenFactory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// The account of the prover that we can use to prove</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> prover_account</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> AccountId</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Address of the Ethereum locker contract.</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> locker_address</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> [</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">u8</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">; </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">20</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">],</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Hashes of the events that were already used.</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> used_events</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> UnorderedSet</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Vec</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">u8</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Mapping from Ethereum tokens to NEAR tokens.</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> tokens</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> UnorderedMap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">EvmAddress</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">AccountId</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">impl</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> BridgeTokenFactory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Initializes the contract.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// `prover_account`: NEAR account of the Near Prover contract;</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// `locker_address`: Ethereum address of the locker contract, in hex.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    #[init]</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> new</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(prover_account</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> AccountId</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, locker_address</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> Self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Relays the lock event from Ethereum.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Uses prover to validate that proof is correct and relies on a canonical Ethereum chain.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Send `mint` action to the token that is specified in the proof.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    #[payable]</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> deposit</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;mut</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, proof</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Proof</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// A callback from BridgeToken contract deployed under this factory.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Is called after tokens are burned there to create an receipt result `(amount, token_address, recipient_address)` for Ethereum to unlock the token.</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> finish_withdraw</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(token_account</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> AccountId</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, amount</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Balance</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, recipient</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> EvmAddress</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Transfers given NEP-21 token from `predecessor_id` to factory to lock.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// On success, leaves a receipt result `(amount, token_address, recipient_address)`.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    #[payable]</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> lock</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;mut</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, token</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> AccountId</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, amount</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Balance</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, recipient</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Relays the unlock event from Ethereum.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Uses prover to validate that proof is correct and relies on a canonical Ethereum chain.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Uses NEP-21 `transfer` action to move funds to `recipient` account.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    #[payable]</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> unlock</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;mut</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, proof</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Proof</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Deploys BridgeToken contract for the given EVM address in hex code.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// The name of new NEP21 compatible contract will be &lt;hex(evm_address)&gt;.&lt;current_id&gt;.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Expects ~35N attached to cover storage for BridgeToken.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    #[payable]</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> deploy_bridge_token</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(address</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Checks if Bridge Token has been successfully deployed with `deploy_bridge_token`.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// On success, returns the name of NEP21 contract associated with given address (&lt;hex(evm_address)&gt;.&lt;current_id&gt;).</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Otherwise, returns &quot;token do not exists&quot; error.</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> get_bridge_token_account_id</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, address</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> AccountId</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> BridgeToken</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">   controller</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> AccountId</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">   token</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Token</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// uses https://github.com/ilblackdragon/balancer-near/tree/master/near-lib-rs</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">impl</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> BridgeToken</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Setup the Token contract with given factory/controller.</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> new</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(controller</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> AccountId</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> Self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Mint tokens to given user. Only can be called by the controller.</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> mint</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;mut</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, account_id</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> AccountId</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, amount</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Balance</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Withdraw tokens from this contract.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Burns sender&#x27;s tokens and calls controller to create event for relaying.</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> withdraw</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;mut</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, amount</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> U128</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, recipient</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Promise</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">impl</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> FungibleToken</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> for</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> BridgeToken</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">   // see example https://github.com/ilblackdragon/balancer-near/blob/master/balancer-pool/src/lib.rs#L329</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<strong class="vocs_Strong">Setup new ERC-20 on NEAR</strong>
<p class="vocs_Paragraph">To setup token contract on NEAR side, anyone can call <code class="vocs_Code">&lt;bridge_token_factory&gt;.deploy_bridge_token(&lt;erc20&gt;)</code> where <code class="vocs_Code">&lt;erc20&gt;</code> is the address of the token.
With this call must attach the amount of $NEAR to cover storage for (at least 30 $NEAR currently).</p>
<p class="vocs_Paragraph">This will create <code class="vocs_Code">&lt;&lt;hex(erc20)&gt;.&lt;bridge_token_factory&gt;&gt;</code> NEP141-compatible contract.</p>
<strong class="vocs_Strong">Usage flow Ethereum -&gt; NEAR</strong>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">User sends <code class="vocs_Code">&lt;erc20&gt;.approve(&lt;erc20locker&gt;, &lt;amount&gt;)</code> Ethereum transaction.</li>
<li class="vocs_ListItem">User sends <code class="vocs_Code">&lt;erc20locker&gt;.lock(&lt;erc20&gt;, &lt;amount&gt;, &lt;destination&gt;)</code> Ethereum transaction. This transaction will create <code class="vocs_Code">Locked</code> event.</li>
<li class="vocs_ListItem">Relayers will be sending Ethereum blocks to the <code class="vocs_Code">EthClient</code> on NEAR side.</li>
<li class="vocs_ListItem">After sufficient number of confirmations on top of the mined Ethereum block that contain the <code class="vocs_Code">lock</code> transaction, user or relayer can call <code class="vocs_Code">BridgeTokenFactory.deposit(proof)</code>. Proof is the extracted information from the event on Ethereum side.</li>
<li class="vocs_ListItem"><code class="vocs_Code">BridgeTokenFactory.deposit</code> function will call <code class="vocs_Code">EthProver</code> and verify that proof is correct and relies on a block with sufficient number of confirmations.</li>
<li class="vocs_ListItem"><code class="vocs_Code">EthProver</code> will return callback to <code class="vocs_Code">BridgeTokenFactory</code> confirming that proof is correct.</li>
<li class="vocs_ListItem"><code class="vocs_Code">BridgeTokenFactory</code> will call <code class="vocs_Code">&lt;&lt;hex(erc20)&gt;.&lt;bridge_token_factory&gt;&gt;.mint(&lt;near_account_id&gt;, &lt;amount&gt;)</code>.</li>
<li class="vocs_ListItem">User can use <code class="vocs_Code">&lt;&lt;hex(erc20)&gt;.&lt;bridge_token_factory&gt;&gt;</code> token in other applications now on NEAR.</li>
</ol>
<strong class="vocs_Strong">Usage flow NEAR -&gt; Ethereum</strong>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><code class="vocs_Code">token-locker</code> locks NEP141 tokens on NEAR side.</li>
</ol>
<p class="vocs_Paragraph">To deposit funds into the locker, call <code class="vocs_Code">ft_transfer_call</code> where <code class="vocs_Code">msg</code> contains Ethereum address the funds should arrive to.
This will emit <code class="vocs_Code">&lt;token: String, amount: u128, recipient address: EthAddress&gt;</code> (which arrives to <code class="vocs_Code">deposit</code> on Ethereum side).</p>
<p class="vocs_Paragraph">Accepts <code class="vocs_Code">Unlock(token: String, sender_id: EthAddress, amount: u256, recipient: String)</code> event from Ethereum side with a proof, verifies its correctness.
If <code class="vocs_Code">recipient</code> contains &#x27;:&#x27; will split it into <code class="vocs_Code">&lt;recipient, msg&gt;</code> and do <code class="vocs_Code">ft_transfer_call(recipient, amount, None, msg)</code>. Otherwise will <code class="vocs_Code">ft_transfer</code> to <code class="vocs_Code">recipient</code>.</p>
<p class="vocs_Paragraph">To get metadata of token to Ethereum, need to call <code class="vocs_Code">log_metadata</code>, which will create a result <code class="vocs_Code">&lt;token: String, name: String, symbol: String, decimals: u8, blockHeight: u64&gt;</code>.</p>
<ol start="2" class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><code class="vocs_Code">erc20-bridge-token</code> - <code class="vocs_Code">BridgeTokenFactory</code> and <code class="vocs_Code">BridgeToken</code> Ethereum contracts.</li>
</ol>
<p class="vocs_Paragraph"><code class="vocs_Code">BridgeTokenFactory</code> creates new <code class="vocs_Code">BridgeToken</code> that correspond to specific token account id on NEAR side.</p>
<p class="vocs_Paragraph"><code class="vocs_Code">BridgeTokenFactory</code> receives <code class="vocs_Code">deposit</code> with proof from NEAR, verify them and mint appropriate amounts on recipient addresses.</p>
<p class="vocs_Paragraph">Calling <code class="vocs_Code">withdraw</code> will burn tokens of this user and will generate event <code class="vocs_Code">&lt;token: String, sender_id: EthAddress, amount: u256, recipient: String&gt;</code> that can be relayed to <code class="vocs_Code">token-factory</code>.</p>
<strong class="vocs_Strong">Caveats</strong>
<p class="vocs_Paragraph">Generally, this connector allows any account to call <code class="vocs_Code">ft_transfer_call</code> opening for potential malicious tokens to be bridged to Ethereum.
The expectation here is that on Ethereum side, the token lists will handle this, as it&#x27;s the same attack model as malicious tokens on Uniswap and other DEXs.</p>
<p class="vocs_Paragraph">Using Ethereum <code class="vocs_Code">BridgeTokenFactory</code> contract can always resolve Ethereum address of a contract back to NEAR one to check that it is indeed bridging token from NEAR and is created by this factory.</p>
<strong class="vocs_Strong">Testing</strong>
<p class="vocs_Paragraph">Testing Ethereum side</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">cd erc20-connector</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">yarn</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">yarn run test</span></span></code></pre></div></div>
<p class="vocs_Paragraph">Testing NEAR side</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">make res/bridge_token_factory.wasm</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">cargo test --all</span></span></code></pre></div></div>
<h2 class="vocs_H2 vocs_Heading"><div id="multi-chain-support" class="vocs_Heading_slugTarget"></div>Multi-chain support<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#multi-chain-support" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h2 class="vocs_H2 vocs_Heading"><div id="economics" class="vocs_Heading_slugTarget"></div>Economics<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#economics" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h2 class="vocs_H2 vocs_Heading"><div id="references" class="vocs_Heading_slugTarget"></div>References<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#references" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Ethereum 2.0 Specifications</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/ethereum/consensus-specs/blob/master/specs/phase0/beacon-chain.mdx" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Beacon Chain Specification</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://notes.ethereum.org/@vbuterin/extended_light_client_protocol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Extended light client protocol</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/ethereum/consensus-specs/blob/dev/specs/altair/light-client/light-client.mdx" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Altair Light Client -- Light Client</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/ethereum/consensus-specs/blob/dev/specs/altair/light-client/sync-protocol.mdx" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Altair Light Client -- Sync Protocol</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/ethereum/consensus-specs/blob/dev/specs/phase0/fork-choice.mdx" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Beacon Chain Fork Choice</a></li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Proving Mechanisms</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://lighthouse-book.sigmaprime.io/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Lighthouse Documentation</a>: ETH 2.0 Consensus Client Lighthouse documentation</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/sigp/lighthouse" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Lighthouse Github</a>: ETH 2.0 Consensus Client Lighthouse Github</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://lighthouse-blog.sigmaprime.io/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Lighthouse: Blog</a>: ETH 2.0 Consensus Client Lighthouse Blog</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/eth2near/eth2near-block-relay-rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2near-block-relay-rs</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/eth/nearbridge" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">nearbridge contracts</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/eth/nearprover" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">nearprover contracts</a></li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Prysm Light Client Work</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jinfwhuang/prysm/pull/5" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Prysm: Light-client (WORK IN PROGRESS)</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jinfwhuang/prysm/tree/jin-light/cmd/light-client#light-client-client" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Prysm: Light-client Client WIP</a>: An independent light client client</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/prysmaticlabs/prysm/pull/10034" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Prysm: light-client server PR</a>: a feature PR that implements the basic production level changes to Prysm to comply as a light-client server to begin serving light client requests</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Harmony Merkle Mount Range</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Harmony <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/harmony-one/harmony/pull/3872" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">MMR PR Review</a> and <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/harmony-one/harmony/pull/4198/files" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">latest PR</a> uses Merkle Mountain Ranges to facilitate light client development against Harmony&#x27;s sharded Proof of Stake Chain</li>
</ul>
</li>
</ul>
<h2 class="vocs_H2 vocs_Heading"><div id="appendices" class="vocs_Heading_slugTarget"></div>Appendices<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#appendices" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="appendix-a---ethereum-to-near-block-propagation-components" class="vocs_Heading_slugTarget"></div>Appendix A - Ethereum to NEAR block propagation components<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#appendix-a---ethereum-to-near-block-propagation-components" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/contract_wrapper/src/eth_client_contract.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">EthClientContract Wrapper</a>: supports <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth2-client/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2-client contract</a> functions <code class="vocs_Code">impl EthClientContractTrait for EthClientContract</code></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">fn get_last_submitted_slot(&amp;self) -&gt; u64</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn is_known_block(&amp;self, execution_block_hash: &amp;H256) -&gt; Result&lt;bool, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn send_light_client_update(&amp;mut self, light_client_update: LightClientUpdate,) -&gt; Result&lt;FinalExecutionOutcomeView, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_finalized_beacon_block_hash(&amp;self) -&gt; Result&lt;H256, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_finalized_beacon_block_slot(&amp;self) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn send_headers(&amp;mut self, headers: &amp;[BlockHeader], end_slot: u64,) -&gt; Result&lt;FinalExecutionOutcomeView, Box&lt;dyn std::error::Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_min_deposit(&amp;self) -&gt; Result&lt;Balance, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn register_submitter(&amp;self) -&gt; Result&lt;FinalExecutionOutcomeView, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn is_submitter_registered(&amp;self,account_id: Option&lt;AccountId&gt;,) -&gt; Result&lt;bool, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_light_client_state(&amp;self) -&gt; Result&lt;LightClientState, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_num_of_submitted_blocks_by_account(&amp;self) -&gt; Result&lt;u32, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_max_submitted_blocks_by_account(&amp;self) -&gt; Result&lt;u32, Box&lt;dyn Error&gt;&gt;</code></li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth2-client/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2-client contract storage</a>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph">High level storage overview</p>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">provides the <code class="vocs_Code">Eth2Client</code> public data stucture</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub struct Eth2Client {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// If set, only light client updates by the trusted signer will be accepted</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    trusted_signer: Option&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">AccountId</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Mask determining all paused functions</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    paused: Mask,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Whether the client validates the updates.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Should only be set to </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">`false`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> for debugging, testing, and diagnostic purposes</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    validate_updates: bool,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Whether the client verifies BLS signatures.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    verify_bls_signatures: bool,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// We store the hashes of the blocks for the past </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">`hashes_gc_threshold`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> headers.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Events that happen past this threshold cannot be verified by the client.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// It is desirable that this number is larger than 7 days&#x27; worth of headers, which is roughly</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// 51k Ethereum blocks. So this number should be 51k in production.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    hashes_gc_threshold: u64,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Network. e.g. mainnet, kiln</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    network: Network,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Hashes of the finalized execution blocks mapped to their numbers. Stores up to </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">`hashes_gc_threshold`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> entries.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Execution block number -&gt; execution block hash</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    finalized_execution_blocks: LookupMap&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">u64,</span><span style="color:#6F42C1;--shiki-dark:#6CB6FF" class="vocs_Span"> H256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// All unfinalized execution blocks&#x27; headers hashes mapped to their </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">`HeaderInfo`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Execution block hash -&gt; ExecutionHeaderInfo object</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    unfinalized_headers: UnorderedMap&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">H256,</span><span style="color:#6F42C1;--shiki-dark:#6CB6FF" class="vocs_Span"> ExecutionHeaderInfo</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">`AccountId`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">s mapped to their number of submitted headers.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Submitter account -&gt; Num of submitted headers</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    submitters: LookupMap&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">AccountId,</span><span style="color:#6F42C1;--shiki-dark:#6CB6FF" class="vocs_Span"> u32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Max number of unfinalized blocks allowed to be stored by one submitter account</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// This value should be at least 32 blocks (1 epoch), but the recommended value is 1024 (32 epochs)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    max_submitted_blocks_by_account: u32,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    // The minimum balance that should be attached to register a new submitter account</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    min_storage_balance_for_submitter: Balance,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Light client state</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    finalized_beacon_header: ExtendedBeaconBlockHeader,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    finalized_execution_header: LazyOption&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">ExecutionHeaderInfo</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    current_sync_committee: LazyOption&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">SyncCommittee</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    next_sync_committee: LazyOption&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">SyncCommittee</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth2-client/Cargo.toml" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2-client dependencies</a> relys heavily on the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">lighthouse</a> codebase for it&#x27;s consensus and cryptogrphic primitives. See <a class="vocs_Anchor" href="/research/bridge/near-rainbow#cryptographic-primitives">Cryptographic Primitives</a> for more information.</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">ethereum-types = &quot;0.9.2&quot;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">eth-types =  { path = &quot;../eth-types&quot; }</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">eth2-utility =  { path = &quot;../eth2-utility&quot; }</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">tree_hash = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">merkle_proof = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">bls = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, optional = true, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot;, default-features = false, features = [&quot;milagro&quot;]}</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">admin-controlled =  { path = &quot;../admin-controlled&quot; }</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">near-sdk = &quot;4.0.0&quot;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">borsh = &quot;0.9.3&quot;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">bitvec = &quot;1.0.0&quot;</code></li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth2-client/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2-client contract functions</a>: provides the following functions in <code class="vocs_Code">impl Eth2Client</code></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">fn validate_light_client_update(&amp;self, update: &amp;LightClientUpdate)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn verify_finality_branch(&amp;self, update: &amp;LightClientUpdate, finalized_period: u64)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn verify_bls_signatures(&amp;self, update: &amp;LightClientUpdate, sync_committee_bits: BitVec&lt;u8&gt;, finalized_period: u64,)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn update_finalized_header(&amp;mut self, finalized_header: ExtendedBeaconBlockHeader)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn commit_light_client_update(&amp;mut self, update: LightClientUpdate)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn gc_finalized_execution_blocks(&amp;mut self, mut header_number: u64)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn update_submitter(&amp;mut self, submitter: &amp;AccountId, value: i64)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn is_light_client_update_allowed(&amp;self)</code></li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/eth2near_relay.rs#L84" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Eth2NearRelay</a>: has the following public structure</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub struct Eth2NearRelay {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    beacon_rpc_client: BeaconRPCClient,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    eth1_rpc_client: Eth1RPCClient,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    near_rpc_client: NearRPCClient,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    eth_client_contract: Box&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">dyn</span><span style="color:#6F42C1;--shiki-dark:#6CB6FF" class="vocs_Span"> EthClientContractTrait</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    headers_batch_size: u64,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    ethereum_network: String,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    interval_between_light_client_updates_submission_in_epochs: u64,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    max_blocks_for_finalization: u64,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    near_network_name: String,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    last_slot_searcher: LastSlotSearcher,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    terminate: bool,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    submit_only_finalized_blocks: bool,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    next_light_client_update: Option&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">LightClientUpdate</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    sleep_time_on_sync_secs: u64,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    sleep_time_after_submission_secs: u64,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    max_submitted_blocks_by_account: u32,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/eth2near_relay.rs#L103" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Eth2NearRelay</a>: Implements the following functions</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">fn get_max_slot_for_submission(&amp;self) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_last_eth2_slot_on_near(&amp;mut self, max_slot: u64) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_last_finalized_slot_on_near(&amp;self) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_last_finalized_slot_on_eth(&amp;self) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem">
<strong class="vocs_Strong"><code class="vocs_Code">pub fn run(&amp;mut self, max_iterations: Option&lt;u64&gt;)</code></strong>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">fn wait_for_synchronization(&amp;self) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_light_client_update_from_file(config: &amp;Config, beacon_rpc_client: &amp;BeaconRPCClient,) -&gt; Result&lt;Option&lt;LightClientUpdate&gt;, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn set_terminate(&amp;mut self, iter_id: u64, max_iterations: Option&lt;u64&gt;)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_execution_blocks_between(&amp;self, start_slot: u64, last_eth2_slot_on_eth_chain: u64,) -&gt; Result&lt;(Vec&lt;BlockHeader&gt;, u64), Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn submit_execution_blocks(&amp;mut self, headers: Vec&lt;BlockHeader&gt;, current_slot: u64,last_eth2_slot_on_near: &amp;mut u64,)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn verify_bls_signature_for_finality_update(&amp;mut self, light_client_update: &amp;LightClientUpdate,) -&gt; Result&lt;bool, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_execution_block_by_slot(&amp;self, slot: u64) -&gt; Result&lt;BlockHeader, Box&lt;dyn Error&gt;&gt;</code></li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/eth2near_relay.rs#L461" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Eth2NearRelay</a>: has a second implementation of functions for submitting light client updates</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">fn is_enough_blocks_for_light_client_update(&amp;self, last_submitted_slot: u64,last_finalized_slot_on_near: u64, last_finalized_slot_on_eth: u64,) -&gt; bool</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn is_shot_run_mode(&amp;self) -&gt; bool</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn send_light_client_updates_with_checks(&amp;mut self, last_submitted_slot: u64) -&gt; bool</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn send_light_client_updates(&amp;mut self, last_submitted_slot: u64, last_finalized_slot_on_near: u64, last_finalized_slot_on_eth: u64,)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn send_light_client_update_from_file(&amp;mut self, last_submitted_slot: u64)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn send_regular_light_client_update(&amp;mut self, last_finalized_slot_on_eth: u64,last_finalized_slot_on_near: u64,)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_attested_slot(&amp;mut self, last_finalized_slot_on_near: u64,) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn send_hand_made_light_client_update(&amp;mut self, last_finalized_slot_on_near: u64)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn send_specific_light_client_update(&amp;mut self, light_client_update: LightClientUpdate)</code></li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/eth2near/eth2-contract-init" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2-contract-init</a> includes (but not limited to) the following additional components</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2-contract-init/src/init_contract.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">init_contract.rs</a>: Verifies light client snapshot and initializes the Ethereum Light Contract on Near.<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">pub fn verify_light_client_snapshot(block_root: String, light_client_snapshot: &amp;LightClientSnapshotWithProof,) -&gt; bool</code>: Verifies the light client by checking the snapshot format getting the current consensus branch and verifying it via a merkle proof.</li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn init_contract(config: &amp;Config, eth_client_contract: &amp;mut EthClientContract, mut init_block_root: String,) -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt;</code>: Initializes the Ethereum Light Client Contract on Near.</li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/eth2near/eth_rpc_client" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth_rpc_client</a> includes (but not limited to) the following additional components</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/eth1_rpc_client.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth1_rpc_client.rs</a>: Is used to get block headers and check sync status. It has the following functions</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">pub fn new(endpoint_url: &amp;str) -&gt; Self</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_block_header_by_number(&amp;self, number: u64) -&gt; Result&lt;BlockHeader, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn is_syncing(&amp;self) -&gt; Result&lt;bool, Box&lt;dyn Error&gt;&gt;</code></li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/execution_block_proof.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">execution_block_proof.rs</a>: <code class="vocs_Code">ExecutionBlockProof</code> contains a <code class="vocs_Code">block_hash</code> (execution block) and a proof of its inclusion in the <code class="vocs_Code">BeaconBlockBody</code> tree hash. The <code class="vocs_Code">block_hash</code> is the 12th field in execution_payload, which is the 9th field in <code class="vocs_Code">BeaconBlockBody</code>. The first 4 elements in proof correspondent to the proof of inclusion of <code class="vocs_Code">block_hash</code> in Merkle tree built for <code class="vocs_Code">ExecutionPayload</code>. The last 4 elements of the proof of <code class="vocs_Code">ExecutionPayload</code> in the Merkle tree are built on high-level <code class="vocs_Code">BeaconBlockBody</code> fields. The proof starts from the leaf. It has the following structure and functions</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">pub struct ExecutionBlockProof {block_hash: H256, proof: [H256; Self::PROOF_SIZE],}</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn construct_from_raw_data(block_hash: &amp;H256, proof: &amp;[H256; Self::PROOF_SIZE]) -&gt; Self</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn construct_from_beacon_block_body(beacon_block_body: &amp;BeaconBlockBody&lt;MainnetEthSpec&gt;,) -&gt; Result&lt;Self, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_proof(&amp;self) -&gt; [H256; Self::PROOF_SIZE]</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_execution_block_hash(&amp;self) -&gt; H256</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn verify_proof_for_hash(&amp;self, beacon_block_body_hash: &amp;H256,) -&gt; Result&lt;bool, IncorrectBranchLength&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn merkle_root_from_branch(leaf: H256, branch: &amp;[H256], depth: usize, index: usize,) -&gt; Result&lt;H256, IncorrectBranchLength&gt;</code></li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth_rpc_client/src/beacon_block_body_merkle_tree.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">beacon_block_body_merkle_tree.rs</a>: implements merkle trees for the Beacon and the ExecutionPayload</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">BeaconBlockBodyMerkleTree</code> is built on the <code class="vocs_Code">BeaconBlockBody</code> data structure, where the leaves of the Merkle Tree are the hashes of the high-level fields of the <code class="vocs_Code">BeaconBlockBody</code>. The hashes of each element are produced by using <code class="vocs_Code">ssz</code> serialization.</li>
<li class="vocs_ListItem"><code class="vocs_Code">ExecutionPayloadMerkleTree</code> is a built on the <code class="vocs_Code">ExecutionPayload</code> data structure, where the leaves of the Merkle Tree are the hashes of the high-level fields of the <code class="vocs_Code">ExecutionPayload</code>. The hashes of each element are produced by using <code class="vocs_Code">ssz</code> serialization. <code class="vocs_Code">ExecutionPayload</code> is one of the field in BeaconBlockBody. The hash of the root of <code class="vocs_Code">ExecutionPlayloadMerkleTree</code> is the 9th leaf in BeaconBlockBody Merkle Tree.</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth_rpc_client/src/beacon_rpc_client.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">beacon_rpc_client.rs</a>: allows getting beacon block body, beacon block header and light client updates using <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://ethereum.github.io/beacon-APIs/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Beacon RPC API</a>. It has the following functions</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">pub fn new(endpoint_url: &amp;str, timeout_seconds: u64, timeout_state_seconds: u64) -&gt; Self</code>: Creates <code class="vocs_Code">BeaconRPCClient</code> for the given BeaconAPI <code class="vocs_Code">endpoint_url</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_beacon_block_body_for_block_id(&amp;self, block_id: &amp;str,) -&gt; Result&lt;BeaconBlockBody&lt;MainnetEthSpec&gt;, Box&lt;dyn Error&gt;&gt;</code>: Returns <code class="vocs_Code">BeaconBlockBody</code> struct for the given <code class="vocs_Code">block_id</code>. It uses the following arguments<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">block_id</code> - Block identifier. Can be one of: <code class="vocs_Code">&quot;head&quot; (canonical head in node&#x27;s view),&quot;genesis&quot;, &quot;finalized&quot;, &lt;slot&gt;, &lt;hex encoded blockRoot with 0x prefix&gt;</code>(see <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://ethereum.github.io/beacon-APIs/#/Beacon/getBlockV2" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">beacon-APIs/#/Beacon/getBlockV2</a>).</li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_beacon_block_header_for_block_id(&amp;self, block_id: &amp;str,) -&gt; Result&lt;types::BeaconBlockHeader, Box&lt;dyn Error&gt;&gt;</code>: Returns <code class="vocs_Code">BeaconBlockHeader</code> struct for the given <code class="vocs_Code">block_id</code>. It uses the following arguments<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">block_id</code> - Block identifier. Can be one of: <code class="vocs_Code">&quot;head&quot; (canonical head in node&#x27;s view),&quot;genesis&quot;, &quot;finalized&quot;, &lt;slot&gt;, &lt;hex encoded blockRoot with 0x prefix&gt;</code>(see <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://ethereum.github.io/beacon-APIs/#/Beacon/getBlockV2" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">beacon-APIs/#/Beacon/getBlockV2</a>).</li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_light_client_update(&amp;self, period: u64,) -&gt; Result&lt;LightClientUpdate, Box&lt;dyn Error&gt;&gt;</code>: Returns <code class="vocs_Code">LightClientUpdate</code> struct for the given <code class="vocs_Code">period</code>. It uses the following arguments<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">period</code> - period id for which <code class="vocs_Code">LightClientUpdate</code> is fetched. On Mainnet, one period consists of 256 epochs, and one epoch consists of 32 slots</li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_bootstrap(&amp;self, block_root: String,) -&gt; Result&lt;LightClientSnapshotWithProof, Box&lt;dyn Error&gt;&gt;</code>: Fetch a bootstrapping state with a proof to a trusted block root. The trusted block root should be fetched with similar means to a weak subjectivity checkpoint. Only block roots for checkpoints are guaranteed to be available.</li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_checkpoint_root(&amp;self) -&gt; Result&lt;String, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_last_finalized_slot_number(&amp;self) -&gt; Result&lt;types::Slot, Box&lt;dyn Error&gt;&gt;</code>: Return the last finalized slot in the Beacon chain</li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_last_slot_number(&amp;self) -&gt; Result&lt;types::Slot, Box&lt;dyn Error&gt;&gt;</code>: Return the last slot in the Beacon chain</li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_slot_by_beacon_block_root(&amp;self, beacon_block_hash: H256,) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_block_number_for_slot(&amp;self, slot: types::Slot) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_finality_light_client_update(&amp;self) -&gt; Result&lt;LightClientUpdate, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_finality_light_client_update_with_sync_commity_update(&amp;self,) -&gt; Result&lt;LightClientUpdate, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_beacon_state(&amp;self, state_id: &amp;str,) -&gt; Result&lt;BeaconState&lt;MainnetEthSpec&gt;, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn is_syncing(&amp;self) -&gt; Result&lt;bool, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_json_from_client(client: &amp;Client, url: &amp;str) -&gt; Result&lt;String, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_json_from_raw_request(&amp;self, url: &amp;str) -&gt; Result&lt;String, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_body_json_from_rpc_result(block_json_str: &amp;str,) -&gt; Result&lt;std::string::String, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_header_json_from_rpc_result(json_str: &amp;str,) -&gt; Result&lt;std::string::String, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_attested_header_from_light_client_update_json_str(light_client_update_json_str: &amp;str,) -&gt; Result&lt;BeaconBlockHeader, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_sync_aggregate_from_light_client_update_json_str(light_client_update_json_str: &amp;str,) -&gt; Result&lt;SyncAggregate, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_signature_slot(&amp;self, light_client_update_json_str: &amp;str,) -&gt; Result&lt;Slot, Box&lt;dyn Error&gt;&gt;</code>: <code class="vocs_Code">signature_slot</code> is not provided in the current API. The slot is brute-forced until <code class="vocs_Code">SyncAggregate</code> in <code class="vocs_Code">BeconBlockBody</code> in the current slot is equal to <code class="vocs_Code">SyncAggregate</code> in <code class="vocs_Code">LightClientUpdate</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_finality_update_from_light_client_update_json_str(&amp;self, light_client_update_json_str: &amp;str,) -&gt; Result&lt;FinalizedHeaderUpdate, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_sync_committee_update_from_light_client_update_json_str(light_client_update_json_str: &amp;str,) -&gt; Result&lt;SyncCommitteeUpdate, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_period_for_slot(slot: u64) -&gt; u64</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_non_empty_beacon_block_header(&amp;self, start_slot: u64,) -&gt; Result&lt;types::BeaconBlockHeader, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn check_block_found_for_slot(&amp;self, json_str: &amp;str) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt;</code></li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth_rpc_client/src/hand_made_finality_light_client_update.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">hand_made_finality_light_client_update.rs</a>: Has two implementations</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">The first implementation which calls functions in the second<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_finality_light_client_update(beacon_rpc_client: &amp;BeaconRPCClient, attested_slot: u64, include_next_sync_committee: bool,) -&gt; Result&lt;LightClientUpdate, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_finality_light_client_update_from_file(beacon_rpc_client: &amp;BeaconRPCClient, file_name: &amp;str,) -&gt; Result&lt;LightClientUpdate, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_light_client_update_from_file_with_next_sync_committee(beacon_rpc_client: &amp;BeaconRPCClient, attested_state_file_name: &amp;str, finality_state_file_name: &amp;str,) -&gt; Result&lt;LightClientUpdate, Box&lt;dyn Error&gt;&gt;</code></li>
</ul>
</li>
<li class="vocs_ListItem">The second implementation<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">fn get_attested_slot_with_enough_sync_committee_bits_sum(beacon_rpc_client: &amp;BeaconRPCClient,attested_slot: u64,) -&gt; Result&lt;(u64, u64), Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_state_from_file(file_name: &amp;str) -&gt; Result&lt;BeaconState&lt;MainnetEthSpec&gt;, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_finality_light_client_update_for_state(beacon_rpc_client: &amp;BeaconRPCClient,attested_slot: u64, signature_slot: u64, beacon_state: BeaconState&lt;MainnetEthSpec&gt;, finality_beacon_state: Option&lt;BeaconState&lt;MainnetEthSpec&gt;&gt;,) -&gt; Result&lt;LightClientUpdate, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_next_sync_committee(beacon_state: &amp;BeaconState&lt;MainnetEthSpec&gt;,) -&gt; Result&lt;SyncCommitteeUpdate, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn from_lighthouse_beacon_header(beacon_header: &amp;BeaconBlockHeader,) -&gt; eth_types::eth2::BeaconBlockHeader</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_sync_committee_bits(sync_committee_signature: &amp;types::SyncAggregate&lt;MainnetEthSpec&gt;,) -&gt; Result&lt;[u8; 64], Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_finality_branch(beacon_state: &amp;BeaconState&lt;MainnetEthSpec&gt;,) -&gt; Result&lt;Vec&lt;H256&gt;, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_finality_update(finality_header: &amp;BeaconBlockHeader, beacon_state: &amp;BeaconState&lt;MainnetEthSpec&gt;, finalized_block_body: &amp;BeaconBlockBody&lt;MainnetEthSpec&gt;,) -&gt; Result&lt;FinalizedHeaderUpdate, Box&lt;dyn Error&gt;&gt;</code></li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth_rpc_client/src/light_client_snapshot_with_proof.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">light_client_snapshot_with_proof.rs</a>: contains the structure for <code class="vocs_Code">LightClientSnapshotWithProof</code></p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub struct LightClientSnapshotWithProof {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    pub beacon_header: BeaconBlockHeader,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    pub current_sync_committee: SyncCommittee,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    pub current_sync_committee_branch: Vec&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">H256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/eth2near/eth2near-block-relay-rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2near-block-relay-rs</a> includes (but not limited to) the following additional components</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/config.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">config.rs</a>:</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/last_slot_searcher.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">last_slot_searcher.rs</a>: Implementation of functions for searching last slot on NEAR contract. Supports both binary and linear searches.<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_last_slot(&amp;mut self, last_eth_slot: u64, beacon_rpc_client: &amp;BeaconRPCClient, eth_client_contract: &amp;Box&lt;dyn EthClientContractTrait&gt;,) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">n binary_slot_search(&amp;self, slot: u64, finalized_slot: u64, last_eth_slot: u64, beacon_rpc_client: &amp;BeaconRPCClient, eth_client_contract: &amp;Box&lt;dyn EthClientContractTrait&gt;,) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code> : Search for the slot before the first unknown slot on NEAR. Assumptions: (1) start_slot is known on NEAR (2) last_slot is unknown on NEAR. Return error in case of problem with network connection.</li>
<li class="vocs_ListItem"><code class="vocs_Code">fn binsearch_slot_forward(&amp;self, slot: u64, max_slot: u64, beacon_rpc_client: &amp;BeaconRPCClient,eth_client_contract: &amp;Box&lt;dyn EthClientContractTrait&gt;,) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt; {</code>: Search for the slot before the first unknown slot on NEAR. Assumptions: (1) start_slot is known on NEAR (2) last_slot is unknown on NEAR. Return error in case of problem with network connection.</li>
<li class="vocs_ListItem"><code class="vocs_Code">fn binsearch_slot_range(&amp;self, start_slot: u64, last_slot: u64, beacon_rpc_client: &amp;BeaconRPCClient, eth_client_contract: &amp;Box&lt;dyn EthClientContractTrait&gt;,) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code>: Search for the slot before the first unknown slot on NEAR. Assumptions: (1) start_slot is known on NEAR (2) last_slot is unknown on NEAR. Return error in case of problem with network connection.</li>
<li class="vocs_ListItem"><code class="vocs_Code">fn linear_slot_search(&amp;self, slot: u64, finalized_slot: u64, last_eth_slot: u64, beacon_rpc_client: &amp;BeaconRPCClient, eth_client_contract: &amp;Box&lt;dyn EthClientContractTrait&gt;,) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code>: Returns the last slot known with block known on NEAR. <code class="vocs_Code">Slot</code> -- expected last known slot. <code class="vocs_Code">finalized_slot</code> -- last finalized slot on NEAR, assume as known slot. <code class="vocs_Code">last_eth_slot</code> -- head slot on Eth.</li>
<li class="vocs_ListItem"><code class="vocs_Code">fn linear_search_forward(&amp;self, slot: u64, max_slot: u64, beacon_rpc_client: &amp;BeaconRPCClient,eth_client_contract: &amp;Box&lt;dyn EthClientContractTrait&gt;,) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code>: Returns the slot before the first unknown block on NEAR. The search range is [slot .. max_slot). If there is no unknown block in this range max_slot - 1 will be returned. Assumptions: (1) block for slot is submitted to NEAR. (2) block for max_slot is not submitted to NEAR.</li>
<li class="vocs_ListItem"><code class="vocs_Code">fn linear_search_backward(&amp;self, start_slot: u64, last_slot: u64, beacon_rpc_client: &amp;BeaconRPCClient, eth_client_contract: &amp;Box&lt;dyn EthClientContractTrait&gt;,) -&gt; Result&lt;u64, Box&lt;dyn Error&gt;&gt;</code>: Returns the slot before the first unknown block on NEAR. The search range is [last_slot .. start_slot). If no such block are found the start_slot will be returned. Assumptions: (1) block for start_slot is submitted to NEAR (2) block for last_slot + 1 is not submitted to NEAR.</li>
<li class="vocs_ListItem"><code class="vocs_Code">fn find_left_non_error_slot(&amp;self, left_slot: u64, right_slot: u64, step: i8, beacon_rpc_client: &amp;BeaconRPCClient, eth_client_contract: &amp;Box&lt;dyn EthClientContractTrait&gt;,) -&gt; (u64, bool)</code>: Find the leftmost non-empty slot. Search range: [left_slot, right_slot). Returns pair: (1) slot_id and (2) is this block already known on Eth client on NEAR. Assume that right_slot is non-empty and it&#x27;s block were submitted to NEAR, so if non correspondent block is found we return (right_slot, false).</li>
<li class="vocs_ListItem"><code class="vocs_Code">fn block_known_on_near( &amp;self, slot: u64, beacon_rpc_client: &amp;BeaconRPCClient,eth_client_contract: &amp;Box&lt;dyn EthClientContractTrait&gt;,) -&gt; Result&lt;bool, Box&lt;dyn Error&gt;&gt;</code>: Check if the block for current slot in Eth2 already were submitted to NEAR. Returns Error if slot doesn&#x27;t contain any block.</li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/main.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">main.rs</a>: <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.rs/clap/latest/clap/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Command Line Argument Parser</a> used to run the Ethereum to Near Block Relay. It contains the following functions<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">fn get_eth_contract_wrapper(config: &amp;Config) -&gt; Box&lt;dyn ContractWrapper&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_dao_contract_wrapper(config: &amp;Config) -&gt; Box&lt;dyn ContractWrapper&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn get_eth_client_contract(config: &amp;Config) -&gt; Box&lt;dyn EthClientContractTrait&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn init_log(args: &amp;Arguments, config: &amp;Config)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt;</code></li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/near_rpc_client.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">near_rpc_client.rs</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">pub fn new(endpoint_url: &amp;str) -&gt; Self</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn check_account_exists(&amp;self, account_id: &amp;str) -&gt; Result&lt;bool, Box&lt;dyn Error&gt;&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn is_syncing(&amp;self) -&gt; Result&lt;bool, Box&lt;dyn Error&gt;&gt;</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="appendix-b---ethereum-light-client-finality-update-verify-components" class="vocs_Heading_slugTarget"></div>Appendix B - Ethereum Light Client Finality Update Verify Components<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#appendix-b---ethereum-light-client-finality-update-verify-components" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/eth2near/finality-update-verify" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">finality-update-verify</a> is called from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/eth2near_relay.rs#L422" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">fn verify_bls_signature_for_finality_update</a> to verify signatures as part of light_client updates. It relies heavily on the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">lighthouse</a> codebase for it&#x27;s consensus and cryptogrphic primitives. See <a class="vocs_Anchor" href="/research/bridge/near-rainbow#cryptographic-primitives">Cryptographic Primitives</a> for more information.</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Dependencies in <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/finality-update-verify/Cargo.toml" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Cargo.toml</a></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">eth-types = { path =&quot;../../contracts/near/eth-types/&quot;, features = [&quot;eip1559&quot;]}</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">bls = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">eth2-utility  = { path =&quot;../../contracts/near/eth2-utility&quot;}</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">tree_hash = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">types =  { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">bitvec = &quot;1.0.0&quot;</code></li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Functions in <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/finality-update-verify/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">lib.rs</a></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">fn h256_to_hash256(hash: H256) -&gt; Hash256</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn tree_hash_h256_to_eth_type_h256(hash: tree_hash::Hash256) -&gt; eth_types::H256</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn to_lighthouse_beacon_block_header(bridge_beacon_block_header: &amp;BeaconBlockHeader,) -&gt; types::BeaconBlockHeader</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn is_correct_finality_update(ethereum_network: &amp;str, light_client_update: &amp;LightClientUpdate,   sync_committee: SyncCommittee,) -&gt; Result&lt;bool, Box&lt;dyn Error&gt;&gt;</code></li>
</ul>
</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="appendix-c---cryptographic-primitives" class="vocs_Heading_slugTarget"></div>Appendix C - Cryptographic Primitives<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#appendix-c---cryptographic-primitives" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Following are cryptographic primitives used in the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/near/eth2-client" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2-client contract</a> and <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/eth2near/finality-update-verify" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">finality-update-verify</a>. Many are from the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">lighthouse</a> codebase. Specifically <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/tree/stable/consensus" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">consensus</a> and <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/tree/stable/crypto" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">crypto</a> functions.</p>
<p class="vocs_Paragraph">Some common primitives</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.rs/bitvec/1.0.1/bitvec/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">bitvec</a>: Addresses memory by bits, for packed collections and bitfields</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.rs/eth2_serde_utils/0.1.0/eth2_serde_utils/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2_serde_utils</a>: Serialization and deserialization utilities useful for JSON representations of Ethereum 2.0 types.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.rs/eth2_hashing/0.2.0/eth2_hashing/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2_hashing</a>: Hashing primitives used in Ethereum 2.0</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.rs/blst/0.3.10/blst/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">blst</a>: The blst crate provides a rust interface to the blst BLS12-381 signature library.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.rs/tree_hash/0.4.0/tree_hash/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">tree_hash</a>: Efficient Merkle-hashing as used in Ethereum 2.0</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.rs/eth2_ssz_types/0.2.1/ssz_types/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2_ssz_types</a>: Provides types with unique properties required for SSZ serialization and Merklization.</li>
</ul>
<p class="vocs_Paragraph">Some Primitives from Lighthouse</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/tree/stable/crypto/bls" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">bls</a>: <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://en.wikipedia.org/wiki/BLS_digital_signature" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Boneh–Lynn–Shacham</a> digital signature support<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/tree/stable/crypto/bls/src/impls" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">impls</a>: Implementations<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/impls/blst.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">blst</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/impls/fake_crypto.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">fake_crypto</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/impls/milagro.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">milagro</a>: support for <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://milagro.apache.org/docs/milagro-intro/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Apache Milagro</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/tree/stable/crypto/bls/src" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">functionality</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/generic_aggregate_public_key.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">generic_aggregate_public_key</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/generic_aggregate_signature.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">generic_aggregate_signature</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/generic_keypair.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">generic_keypair</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/generic_public_key.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">generic_public_key</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/generic_public_key_bytes.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">generic_public_key_bytes</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/generic_secret_key.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">generic_secret_key</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/generic_signature.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">generic_signature</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/generic_signature_bytes.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">generic_signature_bytes</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/generic_signature_set.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">generic_signature_set</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/get_withdrawal_credentials.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">get_withdrawal_credentials</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/crypto/bls/src/zeroize_hash.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">zeroize_hash</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/tree/stable/consensus/merkle_proof" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">merkle_proof</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/tree/stable/consensus/tree_hash" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">tree_hash</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/tree/stable/consensus/types/src" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">types</a>: Implements Ethereum 2.0 types including but not limited to<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/attestation.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">attestation</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/beacon_block.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">beacon_block</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/beacon_committee.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">beacon_committee</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/beacon_state.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">beacon_state</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/builder_bid.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">builder_bid</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/chain_spec.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">chain_spec</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/checkpoint.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">checkpoint</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/contribution_and_proof.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">contribution_and_proof</a>: A Validators aggregate sync committee contribution and selection proof.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/deposit.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">deposit</a>: A deposit to potentially become a beacon chain validator.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/enr_fork_id.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">enr_fork_id</a>: Specifies a fork which allows nodes to identify each other on the network. This fork is used in a nodes local ENR.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/eth_spec.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth_spec</a>: Ethereum Foundation specifications.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/execution_block_hash.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">execution_block_hash</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/execution_payload.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">execution_payload</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/fork.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">fork</a>: Specifies a fork of the <code class="vocs_Code">BeaconChain</code>, to prevent replay attacks.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/free_attestation.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">free_attestation</a>: Note: this object does not actually exist in the spec. We use it for managing attestations that have not been aggregated.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/payload.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">payload</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/signed_aggregate_and_proof.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">signed_aggregate_and_proof</a>: A Validators signed aggregate proof to publish on the <code class="vocs_Code">beacon_aggregate_and_proof</code> gossipsub topic.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/signed_beacon_block.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">signed_beacon_block</a>: A <code class="vocs_Code">BeaconBlock</code> and a signature from its proposer.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/slot_data.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">slot_data</a>: A trait providing a <code class="vocs_Code">Slot</code> getter for messages that are related to a single slot. Useful in making parts of attestation and sync committee processing generic.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/slot_epoch.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">slot_epoch</a>: The <code class="vocs_Code">Slot</code> and <code class="vocs_Code">Epoch</code> types are defined as new types over u64 to enforce type-safety between the two types. Note: Time on Ethereum 2.0 Proof of Stake is divided into slots and epochs. One slot is 12 seconds. One epoch is 6.4 minutes, consisting of 32 slots. One block can be created for each slot.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/sync_aggregate.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">sync_aggregate</a>: Create a <code class="vocs_Code">SyncAggregate</code> from a slice of <code class="vocs_Code">SyncCommitteeContribution</code>s. Equivalent to <code class="vocs_Code">process_sync_committee_contributions</code> from the spec.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/sync_committee.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">sync_committee</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/tree_hash_impls.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">tree_hash_impls</a>: contains custom implementations of <code class="vocs_Code">CachedTreeHash</code> for ETH2-specific types. It makes some assumptions about the layouts and update patterns of other structs in this crate, and should be updated carefully whenever those structs are changed.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse/blob/stable/consensus/types/src/validator.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">validator</a>: Information about a <code class="vocs_Code">BeaconChain</code> validator.</li>
</ul>
</li>
</ul>
<p class="vocs_Paragraph">Some Smart Contracts deployed on Ethereum</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/eth/nearprover" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">nearprover</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearprover/contracts/ProofDecoder.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ProofDecoder.sol</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearprover/contracts/NearProver.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NearProver.sol</a></li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/eth/nearbridge/contracts" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">nearbridge</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/NearDecoder.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NearDecoder.sol</a>: handles decoing of Public Keys, Signatures, BlockProducers and LightClientBlocks using <code class="vocs_Code">Borsh.sol</code></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/Utils.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Utils.sol</a>: handles reading and writing to memory, memoryToBytes and has functions such as <code class="vocs_Code">keccak256Raw</code> and <code class="vocs_Code">sha256Raw</code></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/Borsh.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Borsh.sol</a>: <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://borsh.io/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Borsh</a>: Binary Object Representation Serializer for Hashing. It is meant to be used in security-critical projects as it prioritizes consistency, safety, speed; and comes with a strict specification.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/Ed25519.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Ed25519.sol</a>: <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://ed25519.cr.yp.to/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Ed25519</a> high-speed high-security signatures</li>
</ul>
</li>
</ul>
<p class="vocs_Paragraph">Some Primitives from NEAR Rainbow Bridge</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/near/eth-types" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth-types</a>: utilities to serialize and encode eth2 types using <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://borsh.io/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">borsh</a> and <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://ethereum.org/en/developers/docs/data-structures-and-encoding/rlp" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">rlp</a>.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/near/eth2-utility" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2-utility</a>: Utility functions used for Ethereum 2.0 Consensus. Functions include<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">fn from_str(input: &amp;str) -&gt; Result&lt;Network, Self::Err&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn new(network: &amp;Network) -&gt; Self</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn compute_fork_version(&amp;self, epoch: Epoch) -&gt; Option&lt;ForkVersion&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn compute_fork_version_by_slot(&amp;self, slot: Slot) -&gt; Option&lt;ForkVersion&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub const fn compute_epoch_at_slot(slot: Slot) -&gt; u64</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub const fn compute_sync_committee_period(slot: Slot) -&gt; u64</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub const fn floorlog2(x: u32) -&gt; u32</code>: Compute floor of log2 of a u32.</li>
<li class="vocs_ListItem"><code class="vocs_Code">pub const fn get_subtree_index(generalized_index: u32) -&gt; u32</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn compute_domain(domain_constant: DomainType, fork_version: ForkVersion, genesis_validators_root: H256,) -&gt; H256</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn compute_signing_root(object_root: H256, domain: H256) -&gt; H256</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn get_participant_pubkeys(public_keys: &amp;[PublicKeyBytes], sync_committee_bits: &amp;BitVec&lt;u8, Lsb0&gt;,) -&gt; Vec&lt;PublicKeyBytes&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn convert_branch(branch: &amp;[H256]) -&gt; Vec&lt;ethereum_types::H256&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn validate_beacon_block_header_update(header_update: &amp;HeaderUpdate) -&gt; bool</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn calculate_min_storage_balance_for_submitter(max_submitted_blocks_by_account: u32,) -&gt; Balance</code></li>
</ul>
</li>
</ul>
<strong class="vocs_Strong">Nearbridge Cryptographic Primitives</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/Ed25519.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Ed25519.sol</a>: Solidity implementation of the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://en.wikipedia.org/wiki/EdDSA" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Ed25519</a> which is the EdDSA signature scheme using SHA-512 (SHA-2) and Curve25519 (see <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nbeguier.medium.com/a-real-world-comparison-of-the-ssh-key-algorithms-b26b0b31bfd9" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a>). It has the following functions<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">function pow22501(uint256 v) private pure returns (uint256 p22501, uint256 p11)</code> : Computes (v^(2^250-1), v^11) mod p</li>
<li class="vocs_ListItem"><code class="vocs_Code">function check(bytes32 k, bytes32 r, bytes32 s, bytes32 m1, bytes9 m2)</code> : has the following steps<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Step 1: compute SHA-512(R, A, M)</li>
<li class="vocs_ListItem">Step 2: unpack k</li>
<li class="vocs_ListItem">Step 3: compute multiples of k</li>
<li class="vocs_ListItem">Step 4: compute s<em>G - h</em>A</li>
<li class="vocs_ListItem">Step 5: compare the points</li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/Utils.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Utils.sol</a>: A set of utilty functions for byte manipulation, memory updates and <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://keccak.team/keccak_specs_summary.html" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">keccak</a> functions.<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">function swapBytes2(uint16 v) internal pure returns (uint16)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function swapBytes4(uint32 v) internal pure returns (uint32)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function swapBytes8(uint64 v) internal pure returns (uint64)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function swapBytes16(uint128 v) internal pure returns (uint128)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function swapBytes32(uint256 v) internal pure returns (uint256)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function readMemory(uint ptr) internal pure returns (uint res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function writeMemory(uint ptr, uint value) internal pure</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function memoryToBytes(uint ptr, uint length) internal pure returns (bytes memory res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function keccak256Raw(uint ptr, uint length) internal pure returns (bytes32 res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function sha256Raw(uint ptr, uint length) internal view returns (bytes32 res)</code></li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/Borsh.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Borsh.sol</a> provides Binary Object Representation Serializer for Hashing <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://borsh.io/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">borsh</a> functionality and imports <code class="vocs_Code">Utils.sols</code>. Structures and functions include<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">struct Data {uint ptr; uint end;}</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function from(bytes memory data) internal pure returns (Data memory res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function requireSpace(Data memory data, uint length) internal pure</code>: This function assumes that length is reasonably small, so that data.ptr + length will not overflow. In the current code, length is always less than 2^32.</li>
<li class="vocs_ListItem"><code class="vocs_Code">function read(Data memory data, uint length) internal pure returns (bytes32 res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function done(Data memory data) internal pure</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function peekKeccak256(Data memory data, uint length) internal pure returns (bytes32)</code>: Same considerations as for requireSpace.</li>
<li class="vocs_ListItem"><code class="vocs_Code">function peekSha256(Data memory data, uint length) internal view returns (bytes32)</code>: Same considerations as for requireSpace.</li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeU8(Data memory data) internal pure returns (uint8)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeU16(Data memory data) internal pure returns (uint16)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeU32(Data memory data) internal pure returns (uint32)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeU64(Data memory data) internal pure returns (uint64)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeU128(Data memory data) internal pure returns (uint128)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeU256(Data memory data) internal pure returns (uint256)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeBytes20(Data memory data) internal pure returns (bytes20)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeBytes32(Data memory data) internal pure returns (bytes32)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeBool(Data memory data) internal pure returns (bool)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function skipBytes(Data memory data) internal pure</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeBytes(Data memory data) internal pure returns (bytes memory res)</code></li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/NearDecoder.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NearDecoder.sol</a>: Imports <code class="vocs_Code">Borsh.sol</code> and has utilities for decoding Public Keys, Signatures, Block Producers, Block Headers and Light Client Blocks.<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">function decodePublicKey(Borsh.Data memory data) internal pure returns (PublicKey memory res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeSignature(Borsh.Data memory data) internal pure returns (Signature memory res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeBlockProducer(Borsh.Data memory data) internal pure returns (BlockProducer memory res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeBlockProducers(Borsh.Data memory data) internal pure returns (BlockProducer[] memory res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeOptionalBlockProducers(Borsh.Data memory data) internal view returns (OptionalBlockProducers memory res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeOptionalSignature(Borsh.Data memory data) internal pure returns (OptionalSignature memory res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeBlockHeaderInnerLite(Borsh.Data memory data) internal view returns (BlockHeaderInnerLite memory res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeLightClientBlock(Borsh.Data memory data) internal view returns (LightClientBlock memory res)</code></li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearprover/contracts/ProofDecoder.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ProofDecoder.sol</a>: Imports <code class="vocs_Code">Borsh.sol</code> and <code class="vocs_Code">NearDecoder.sol</code> and has utilities for decoding Proofs, BlockHeader, ExecutionStatus, ExecutionOutcome and MerklePaths. Structures and functions include<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">struct FullOutcomeProof {ExecutionOutcomeWithIdAndProof outcome_proof; MerklePath outcome_root_proof; BlockHeaderLight block_header_lite; MerklePath block_proof;}</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeFullOutcomeProof(Borsh.Data memory data) internal view returns (FullOutcomeProof memory proof)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">struct BlockHeaderLight {bytes32 prev_block_hash; bytes32 inner_rest_hash; NearDecoder.BlockHeaderInnerLite inner_lite; bytes32 hash;}</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeBlockHeaderLight(Borsh.Data memory data) internal view returns (BlockHeaderLight memory header)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">struct ExecutionStatus {uint8 enumIndex; bool unknown; bool failed; bytes successValue; bytes32 successReceiptId;}</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">successValue</code> indicates if the final action succeeded and returned some value or an empty vec.</li>
<li class="vocs_ListItem"><code class="vocs_Code">successReceiptId</code> is the final action of the receipt returned a promise or the signed transaction was converted to a receipt. Contains the receipt_id of the generated receipt.</li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeExecutionStatus(Borsh.Data memory data) internal pure returns (ExecutionStatus memory executionStatus)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">struct ExecutionOutcome {bytes[] logs; bytes32[] receipt_ids; uint64 gas_burnt; uint128 tokens_burnt; bytes executor_id; ExecutionStatus status; bytes32[] merkelization_hashes;}</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">bytes[] logs;</code>: Logs from this transaction or receipt.</li>
<li class="vocs_ListItem"><code class="vocs_Code">bytes32[] receipt_ids;</code>: Receipt IDs generated by this transaction or receipt.</li>
<li class="vocs_ListItem"><code class="vocs_Code">uint64 gas_burnt;</code>: The amount of the gas burnt by the given transaction or receipt.</li>
<li class="vocs_ListItem"><code class="vocs_Code">uint128 tokens_burnt;</code>: The total number of the tokens burnt by the given transaction or receipt.</li>
<li class="vocs_ListItem"><code class="vocs_Code">bytes executor_id;</code>: Hash of the transaction or receipt id that produced this outcome.</li>
<li class="vocs_ListItem"><code class="vocs_Code">ExecutionStatus status</code>: Execution status. Contains the result in case of successful execution.</li>
<li class="vocs_ListItem"><code class="vocs_Code">bytes32[] merkelization_hashes;</code></li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeExecutionOutcome(Borsh.Data memory data) internal view returns (ExecutionOutcome memory outcome)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">struct ExecutionOutcomeWithId {bytes32 id; ExecutionOutcome outcome; bytes32 hash;}</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">bytes32 id</code>: is the transaction hash or the receipt ID.</li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeExecutionOutcomeWithId(Borsh.Data memory data) internal view returns (ExecutionOutcomeWithId memory outcome)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">struct MerklePathItem {bytes32 hash; uint8 direction;}</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">uint8 direction</code>: where 0 = left, 1 = right</li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeMerklePathItem(Borsh.Data memory data) internal pure returns (MerklePathItem memory item)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">struct MerklePath {MerklePathItem[] items;}</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeMerklePath(Borsh.Data memory data) internal pure returns (MerklePath memory path)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">struct ExecutionOutcomeWithIdAndProof {MerklePath proof; bytes32 block_hash; ExecutionOutcomeWithId outcome_with_id;}</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function decodeExecutionOutcomeWithIdAndProof(Borsh.Data memory data)internal view returns (ExecutionOutcomeWithIdAndProof memory outcome)</code></li>
</ul>
</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="appendix-d---near-to-ethereum-block-propagation-costing" class="vocs_Heading_slugTarget"></div>Appendix D - NEAR to Ethereum block propagation costing<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#appendix-d---near-to-ethereum-block-propagation-costing" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The following links provide the production Ethereum addresses and blockexplorer views for NearBridge.sol and the ERC20 Locker</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge-client/tree/main/packages/client#ethereum-mainnet-bridge-addresses-and-parameters" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Ethereum Mainnet Bridge addresses and parameters</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://etherscan.io/address/0x3fefc5a4b1c02f21cbc8d3613643ba0635b9a873" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NearBridge.sol on Ethereum Block Explorer</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://etherscan.io/tx/0xa0fbf1405747dbc1c1bda1227e46bc7c5feac36c0eeaab051022cfdb268e60cc/advanced" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Sample <code class="vocs_Code">addLightClientBlock(bytes data)</code> function call</a></li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://etherscan.io/address/0x23ddd3e3692d1861ed57ede224608875809e127f#code" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NEAR ERC20Locker on Ethereum Block Explorer</a></li>
</ul>
<p class="vocs_Paragraph">At time of writing (Oct 26th, 2022).</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">NEAR Light Client Blocks are propogated every <code class="vocs_Code">4 hours</code></li>
<li class="vocs_ListItem">Sample Transaction fee <code class="vocs_Code">0.061600109576901025 Ether ($96.56)</code></li>
<li class="vocs_ListItem">Daily Transaction fees cost approximately <code class="vocs_Code">$600</code></li>
<li class="vocs_ListItem"><em>Note: Infrastructure costs for running relayer, watchdog, etc are not included.</em></li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="appendix-f---near-to-ethereum-block-propagation-components" class="vocs_Heading_slugTarget"></div>Appendix F - NEAR to Ethereum block propagation components<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#appendix-f---near-to-ethereum-block-propagation-components" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/cli/commands/start/eth2near-relay.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2near-relay</a>: Command to start the NEAR to Ethereum relay. See sample invocation <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/docs/development.md#near2eth-relay" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/near2eth/near2eth-block-relay" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">near2eth-block-relay</a> is written in javascript<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Has <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/near2eth/near2eth-block-relay/package.json" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">dependencies</a> including <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/utils" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">rainbow-bridge-utils</a> see <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="/research/bridge/near-rainbow/near-rainbow-bridge-utils" data-discover="true">here</a> for more information. It&#x27;s other dependencies are also included in <code class="vocs_Code">rainbow-bridge-utils</code>.<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://www.npmjs.com/package/ethereumjs-util" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ethereumjs-util</a>: A collection of utility functions for Ethereum.</li>
</ul>
</li>
<li class="vocs_ListItem">Has the following functions and classes<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">class Near2EthRelay</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">async initialize ({nearNodeUrl, nearNetworkId, ethNodeUrl, ethMasterSk, ethClientArtifactPath, ethClientAddress, ethGasMultiplier, metricsPort })</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">async withdraw ({ethGasMultiplier})</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">async runInternal ({submitInvalidBlock, near2ethRelayMinDelay, near2ethRelayMaxDelay, near2ethRelayErrorDelay, near2ethRelayBlockSelectDuration, near2ethRelayNextBlockSelectDelayMs, near2ethRelayAfterSubmitDelayMs, ethGasMultiplier, ethUseEip1559, logVerbose})</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">run (options) {return this.runInternal({...options, submitInvalidBlock: false}) }</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/NearBridge.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NearBridge.sol</a>: Is the NEAR light client deployed on ethereum.<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">It imports the following contracts (see <a class="vocs_Anchor" href="/research/bridge/near-rainbow#nearbridge-cryptographic-primitives">nearbridge cryptographic primitives</a>)<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">import &quot;./AdminControlled.sol&quot;;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">import &quot;./INearBridge.sol&quot;;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">import &quot;./NearDecoder.sol&quot;;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">import &quot;./Ed25519.sol&quot;;</code></li>
</ul>
</li>
<li class="vocs_ListItem">It provides the following structure for Bridge State. If there is currently no unconfirmed block, the last three fields are zero.<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">uint currentHeight;</code>: Height of the current confirmed block</li>
<li class="vocs_ListItem"><code class="vocs_Code">uint nextTimestamp;</code>: Timestamp of the current unconfirmed block</li>
<li class="vocs_ListItem"><code class="vocs_Code">uint nextValidAt;</code>: Timestamp when the current unconfirmed block will be confirmed</li>
<li class="vocs_ListItem"><code class="vocs_Code">uint numBlockProducers;</code>: Number of block producers for the current unconfirmed block</li>
</ul>
</li>
<li class="vocs_ListItem">It provides the following storage<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">uint constant MAX_BLOCK_PRODUCERS = 100;</code>: Assumed to be even and to not exceed 256.</li>
<li class="vocs_ListItem"><code class="vocs_Code">struct Epoch {bytes32 epochId; uint numBPs; bytes [MAX_BLOCK_PRODUCERS] keys; bytes32[MAX_BLOCK_PRODUCERS / 2] packedStakes; uint256 stakeThreshold;}</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">uint256 public lockEthAmount;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">uint256 public lockDuration;</code>: lockDuration and replaceDuration shouldn&#x27;t be extremely big, so adding them to an uint64 timestamp should not overflow uint256.</li>
<li class="vocs_ListItem"><code class="vocs_Code">uint256 public replaceDuration;</code>: replaceDuration is in nanoseconds, because it is a difference between NEAR timestamps.</li>
<li class="vocs_ListItem"><code class="vocs_Code">Ed25519 immutable edwards;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">uint256 public lastValidAt;</code>: End of challenge period. If zero, <em><code class="vocs_Code">untrusted</code></em> fields and <code class="vocs_Code">lastSubmitter</code> are not meaningful.</li>
<li class="vocs_ListItem"><code class="vocs_Code">uint64 curHeight;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">uint64 untrustedHeight;</code>: The most recently added block. May still be in its challenge period, so should not be trusted.</li>
<li class="vocs_ListItem"><code class="vocs_Code">address lastSubmitter;</code>: Address of the account which submitted the last block.</li>
<li class="vocs_ListItem"><code class="vocs_Code">bool public initialized;</code>: Whether the contract was initialized.</li>
<li class="vocs_ListItem"><code class="vocs_Code">bool untrustedNextEpoch;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">bytes32 untrustedHash;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">bytes32 untrustedMerkleRoot;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">bytes32 untrustedNextHash;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">uint256 untrustedTimestamp;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">uint256 untrustedSignatureSet;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">NearDecoder.Signature[MAX_BLOCK_PRODUCERS] untrustedSignatures;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">Epoch[3] epochs;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">uint256 curEpoch;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">mapping(uint64 =&gt; bytes32) blockHashes_;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">mapping(uint64 =&gt; bytes32) blockMerkleRoots_;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">mapping(address =&gt; uint256) public override balanceOf;</code></li>
</ul>
</li>
<li class="vocs_ListItem">It provides the following functions<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">constructor(Ed25519 ed, uint256 lockEthAmount_, uint256 lockDuration_, uint256 replaceDuration_, address admin_, uint256 pausedFlags_)</code>: _Note: require the <code class="vocs_Code">lockDuration</code> (in seconds) to be at least one second less than the <code class="vocs_Code">replaceDuration</code> (in nanoseconds) <code class="vocs_Code">require(replaceDuration* &gt; lockDuration* _ 1000000000);</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">ethEd25519Address</code>: The address of the ECDSA signature checker using Ed25519 curve (see <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nbeguier.medium.com/a-real-world-comparison-of-the-ssh-key-algorithms-b26b0b31bfd9" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a>)</li>
<li class="vocs_ListItem"><code class="vocs_Code">lockEthAmount</code>: The amount that <code class="vocs_Code">BLOCK_PRODUCERS</code> need to deposit (in wei)to be able to provide blocks. This amount will be slashed if the block is challenged and proven not to have a valid signature. Default value is 100000000000000000000 WEI = 100 ETH.</li>
<li class="vocs_ListItem"><code class="vocs_Code">lockDuration</code> : 30 seconds</li>
<li class="vocs_ListItem"><code class="vocs_Code">replaceDuration</code>: 60 seconds it is passed in nanoseconds, because it is a difference between NEAR timestamps.</li>
<li class="vocs_ListItem"><code class="vocs_Code">ethAdminAddress</code>: Bridge Administrator Address</li>
<li class="vocs_ListItem"><code class="vocs_Code">0</code> : Indicates nothing is paused <code class="vocs_Code">UNPAUSE_ALL</code></li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">function deposit() public payable override pausable(PAUSED_DEPOSIT)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function withdraw() public override pausable(PAUSED_WITHDRAW)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function challenge(address payable receiver, uint signatureIndex) external override pausable(PAUSED_CHALLENGE</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function checkBlockProducerSignatureInHead(uint signatureIndex) public view override returns (bool)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function initWithValidators(bytes memory data) public override onlyAdmin</code>: The first part of initialization -- setting the validators of the current epoch.</li>
<li class="vocs_ListItem"><code class="vocs_Code">function initWithBlock(bytes memory data) public override onlyAdmin</code>: The second part of the initialization -- setting the current head.</li>
<li class="vocs_ListItem"><code class="vocs_Code">function bridgeState() public view returns (BridgeState memory res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function bridgeState() public view returns (BridgeState memory res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function addLightClientBlock(bytes memory data) public override pausable(PAUSED_ADD_BLOCK)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function setBlockProducers(NearDecoder.BlockProducer[] memory src, Epoch storage epoch) internal</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function blockHashes(uint64 height) public view override pausable(PAUSED_VERIFY) returns (bytes32 res)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function blockMerkleRoots(uint64 height) public view override pausable(PAUSED_VERIFY) returns (bytes32 res)</code></li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearprover/contracts/NearProver.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NearProver.sol</a>: Is used to prove the validity of NEAR blocks on Ethereum.<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">It imports the following contracts (see <a class="vocs_Anchor" href="/research/bridge/near-rainbow#nearbridge-cryptographic-primitives">nearbridge cryptographic primitives</a>)<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">import &quot;rainbow-bridge-sol/nearbridge/contracts/NearDecoder.sol&quot;;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">import &quot;./ProofDecoder.sol&quot;;</code></li>
</ul>
</li>
<li class="vocs_ListItem">It has the following functions<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">constructor(INearBridge _bridge, address _admin, uint _pausedFlags)</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">_bridge</code>: Interface to <code class="vocs_Code">NearBridge.sol</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">_admin</code>: Administrator address</li>
<li class="vocs_ListItem"><code class="vocs_Code">_pausedFlags</code>: paused indicator defaults to <code class="vocs_Code">UNPAUSE_ALL = 0</code></li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">function proveOutcome(bytes memory proofData, uint64 blockHeight)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function _computeRoot(bytes32 node, ProofDecoder.MerklePath memory proof) internal pure returns (bytes32 hash)</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="appendix-g---near-rainbow-bridge-utils" class="vocs_Heading_slugTarget"></div>Appendix G - NEAR Rainbow Bridge Utils<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#appendix-g---near-rainbow-bridge-utils" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/utils" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">rainbow-bridge-utils</a> provides a set of utilities for the near rainbow bridge written in javascript.</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">It has the following <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/utils/package.json" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">dependencies</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://www.npmjs.com/package/bn.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">bn.js</a>: Big number implementation in pure javascript</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://www.npmjs.com/package/bsert" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">bsert</a>: Minimal assert with type checking.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://www.npmjs.com/package/bs58" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">bs58</a>: JavaScript component to compute base 58 encoding</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://www.npmjs.com/package/change-case" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">change-case</a>: Transform a string between camelCase, PascalCase, Capital Case, snake_case, param-case, CONSTANT_CASE and others.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://www.npmjs.com/package/configstore" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">configstore</a>: Easily load and save config without having to think about where and how</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/near/eth-object#383b6ea68c7050bea4cab6950c1d5a7fa553e72b" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth-object</a>: re-usable and composable objects that you can just call Object.from to ingest new data to serialize Ethereum Trie / LevelDB data from hex, buffers and rpc into the same format.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/near/eth-util-lite" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth-util-lite</a>: a low-dependency utility for Ethereum. It replaces a small subset of the ethereumjs-util and ethjs-util APIs.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://www.npmjs.com/package/lodash" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">lodash</a>: A set of utilities for working with arrays, numbers, objects, strings, etc.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://www.npmjs.com/package/near-api-js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">near-api-js</a>: JavaScript library to interact with NEAR Protocol via RPC API</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://www.npmjs.com/package/web3" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">web3</a>: Ethereum JavaScript API</li>
</ul>
</li>
<li class="vocs_ListItem">It provides the following functions<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/utils/address-watcher.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">address-watcher</a>: Watches a group of near and ethereum acccounts polling NEAR and Ethereum every second and updating <code class="vocs_Code">nearAccount.balanceGauge</code>, <code class="vocs_Code">nearAccount.stateStorageGauge</code> and <code class="vocs_Code">ethereumAccount.balanceGauge</code>.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/utils/borsh.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">borsh</a>: provides the following functions for Binary Object Representation Serializer for Hashing <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://borsh.io/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">borsh</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">function serializeField (schema, value, fieldType, writer)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function deserializeField (schema, fieldType, reader)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function serialize (schema, fieldType, obj)</code>: Serialize given object using schema of the form: <code class="vocs_Code">{ class_name -&gt; [ [field_name, field_type], .. ], .. }</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">class BinaryReader</code>: Includes utilities to read numbers, strings arrays and burggers</li>
<li class="vocs_ListItem"><code class="vocs_Code">function deserialize (schema, fieldType, buffer)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">const signAndSendTransactionAsync = async (accessKey, account, receiverId,actions) =&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">const txnStatus = async (account, txHash, retries = RETRY_TX_STATUS, wait = 1000) =&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function getBorshTransactionLastResult (txResult)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">class BorshContract {</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">constructor (borshSchema, account, contractId, options)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">async accessKeyInit ()</code></li>
</ul>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">function borshify (block)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function borshifyInitialValidators (initialValidators)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">const hexToBuffer = (hex) =&gt;</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">const readerToHex = (len) =&gt;</code></li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/utils/borshify-proof.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">borshify-proof</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">function borshifyOutcomeProof (proof)</code></li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/utils/robust.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">robust</a>: his module gives a few utils for robust error handling, and wrap web3 with error handling and retry</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/utils/utils.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">utils</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">async function setupNear (config)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">async function setupEth (config)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">async function setupEthNear (config)</code>: Setup connection to NEAR and Ethereum from given configuration.</li>
<li class="vocs_ListItem"><code class="vocs_Code">function remove0x (value)</code>: Remove 0x if prepended</li>
<li class="vocs_ListItem"><code class="vocs_Code">function normalizeHex (value)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">async function accountExists (connection, accountId)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">async function createLocalKeyStore (networkId, keyPath)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function getWeb3 (config)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function getEthContract (web3, path, address)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">function addSecretKey (web3, secretKey)</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">async function ethCallContract (contract, methodName, args)</code>: Wrap pure calls to Web3 contract to handle errors/reverts/gas usage.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="appendix-h---token-transfer-components" class="vocs_Heading_slugTarget"></div>Appendix H - Token Transfer Components<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#appendix-h---token-transfer-components" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><em>Note: This uses Ethreum <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://eips.ethereum.org/EIPS/eip-20" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ERC20</a> and NEAR <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nomicon.io/Standards/Tokens/FungibleToken/Core" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NEP-141</a> initally developed for <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/near/NEPs/pull/21" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NEP-21</a></em></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">rainbow-token-connector</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">NEAR rust based contracts<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/tree/master/bridge-common" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">bridge-common</a>: Common functions for NEAR, currently only <code class="vocs_Code">pub fn parse_recipient(recipient: String) -&gt; Recipient</code></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/tree/master/bridge-token-factory" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">bridge-token-factory</a>: Functions for managing tokens on NEAR including but not limited to <code class="vocs_Code">update_metadata</code>, <code class="vocs_Code">deposit</code>, <code class="vocs_Code">get_tokens</code>, <code class="vocs_Code">finish_updating_metadata</code>, <code class="vocs_Code">finish_updating_metadata</code>, <code class="vocs_Code">finish_withdraw</code>, <code class="vocs_Code">deploy_bridge_token</code>, <code class="vocs_Code">get_bridge_token_account_id</code>, <code class="vocs_Code">is_used_proof</code>, <code class="vocs_Code">record_proof</code></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/tree/master/bridge-token" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">bridge-token</a>: Token functions on NEAR including but not limited to <code class="vocs_Code">mint</code> and <code class="vocs_Code">withdraw</code></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/tree/master/token-locker" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">token-locker</a>: Token Locker functions on NEAR including but not limited to <code class="vocs_Code">withdraw</code>, <code class="vocs_Code">finish_deposit</code>, <code class="vocs_Code">is_used_proof</code></li>
</ul>
</li>
<li class="vocs_ListItem">Ethereum solidity based contracts<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/tree/master/erc20-bridge-token" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">erc20-bridge-token</a>: Ethereum Bridge token contracts including but not limited to<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/blob/master/erc20-bridge-token/contracts/BridgeToken.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">BridgeToken.sol</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/blob/master/erc20-bridge-token/contracts/BridgeTokenFactory.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">BridgeTokenFactory.sol</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/blob/master/erc20-bridge-token/contracts/BridgeTokenProxy.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">BridgeTokenProxy.sol</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/blob/master/erc20-bridge-token/contracts/ProofConsumer.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ProofConsumer.sol</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/blob/master/erc20-bridge-token/contracts/ResultsDecoder.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ResultsDecoder</a></li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/tree/master/erc20-connector" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">erc20-connector</a>: has <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/blob/master/erc20-connector/contracts/ERC20Locker.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ERC20Locker.sol</a> which is used to lock and unlock tokens. It is linked to the bridge token factory on NEAR side. It also links to the prover that it uses to unlock the tokens. (see <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/eth/nearbridge/contracts" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a>)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="appendix-i---near-rainbow-bridge-component-overview" class="vocs_Heading_slugTarget"></div>Appendix I - NEAR Rainbow Bridge: Component Overview<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#appendix-i---near-rainbow-bridge-component-overview" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The following smart contracts are deployed on NEAR and work in conjunction with eth2near bridging functionality to propogate blocks from Ethereum to NEAR.</p>
<p class="vocs_Paragraph"><strong class="vocs_Strong">*Note</strong> here we will focus on the <code class="vocs_Code">eth2-client</code> for ETH 2.0 Proof of Stake Bridging however if interested in however there is also an <code class="vocs_Code">eth-client</code> which was used for ETH 1.0 Proof of Work Integration using <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/nearprotocol/rust-ethash" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">rust-ethhash</a>.*</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Smart Contracts Deployed on NEAR</a></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/near/eth2-client" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2-client</a> implements the Ethereum Light Client on Near<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph">it provides functions including but not limited to:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">validate the light client</li>
<li class="vocs_ListItem">verify the finality branch</li>
<li class="vocs_ListItem">verify bls signatures</li>
<li class="vocs_ListItem">update finalized headers</li>
<li class="vocs_ListItem">updates the submittes</li>
<li class="vocs_ListItem">prune finalized blocks.</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">It interacts with the beach chain, uses <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://borsh.io/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Borsh</a> for serialization and <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/lighthouse" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">lighthouse</a> for Ethereum 2.0 Consensus and tree_hash functions as well as bls signatures. See <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://lighthouse-book.sigmaprime.io/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a> for more information on lighthouse. Below is a list of dependencies from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth2-client/Cargo.toml" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2-client/Cargo.toml</a></p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">dependencies</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">ethereum-types = &quot;0.9.2&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">eth-types =  { path = &quot;../eth-types&quot; }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">eth2-utility =  { path = &quot;../eth2-utility&quot; }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">tree_hash = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">merkle_proof = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">bls = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, optional = true, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot;, default-features = false, features = [</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">&quot;milagro&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]}</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">admin-controlled =  { path = &quot;../admin-controlled&quot; }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">near-sdk = &quot;4.0.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">borsh = &quot;0.9.3&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">bitvec = &quot;1.0.0&quot;</span></span></code></pre></div></div>
</li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/eth2near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2near</a> supports the relaying of blocks and the verification of finality between etherum and Near. It has the following components</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/eth2near/contract_wrapper" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">contract_wrapper</a>: provides rust wrappers for interacting with the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">solidity contracts on near</a></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Contracts include (from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/contract_wrapper/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)"><code class="vocs_Code">lib.rs</code></a>)</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod contract_wrapper_trait;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod dao_contract;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod dao_eth_client_contract;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod dao_types;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod errors;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod eth_client_contract;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod eth_client_contract_trait;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod file_eth_client_contract;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod near_contract_wrapper;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod sandbox_contract_wrapper;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod utils;</span></span></code></pre></div></div>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Dependencies include (from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/contract_wrapper/Cargo.toml" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">contract_wrapper/Cargo.toml</a>)</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">dependencies</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">borsh = &quot;0.9.3&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">futures = &quot;0.3.21&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">async-std = &quot;1.12.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">near-sdk = &quot;4.0.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">near-jsonrpc-client = &quot;=0.4.0-beta.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">near-crypto = &quot;0.14.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">near-primitives = &quot;0.14.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">near-chain-configs = &quot;0.14.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">near-jsonrpc-primitives = &quot;0.14.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">tokio = { version = &quot;1.1&quot;, features = [&quot;rt&quot;, &quot;macros&quot;] }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">reqwest = { version = &quot;0.11&quot;, features = [</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">&quot;blocking&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">] }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">serde_json = &quot;1.0.74&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">serde = { version = &quot;1.0&quot;, features = [</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">&quot;derive&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">] }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">eth-types = { path = &quot;../../contracts/near/eth-types/&quot;, features = [</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">&quot;eip1559&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]}</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">workspaces = &quot;0.5.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">anyhow = &quot;1.0&quot;</span></span></code></pre></div></div>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/eth2near/eth2near-block-relay-rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2near-block-relay-rs</a> is built in rust and integrates with the Ethereum 2.0 lgihthouse consensus client to propogate blocks to near.</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Functionality includes (from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">lib.rs</a>)</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod beacon_block_body_merkle_tree;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod beacon_rpc_client;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod config;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod eth1_rpc_client;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod eth2near_relay;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod execution_block_proof;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod hand_made_finality_light_client_update;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod init_contract;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod last_slot_searcher;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod light_client_snapshot_with_proof;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod logger;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod near_rpc_client;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod prometheus_metrics;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub mod relay_errors;</span></span></code></pre></div></div>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Dependencies include (from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/Cargo.toml" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2near-block-relay-rs/Cargo.toml</a>)</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">types =  { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">tree_hash = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;,  rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">merkle_proof = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">eth2_hashing = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">eth2_ssz = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">eth-types = { path = &quot;../../contracts/near/eth-types/&quot;, features = [</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">&quot;eip1559&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]}</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">eth2-utility  = { path = &quot;../../contracts/near/eth2-utility&quot; }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">contract_wrapper = { path = &quot;../contract_wrapper&quot; }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">finality-update-verify = { path = &quot;../finality-update-verify&quot; }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">log = { version = &quot;0.4&quot;, features = [&quot;std&quot;, &quot;serde&quot;] }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">serde_json = &quot;1.0.74&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">serde = { version = &quot;1.0&quot;, features = [</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">&quot;derive&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">] }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">ethereum-types = &quot;0.9.2&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">reqwest = { version = &quot;0.11&quot;, features = [</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">&quot;blocking&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">] }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">clap = { version = &quot;3.1.6&quot;, features = [</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">&quot;derive&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">] }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">tokio = { version = &quot;1.1&quot;, features = [&quot;macros&quot;, &quot;rt&quot;, &quot;time&quot;] }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">env_logger = &quot;0.9.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">borsh = &quot;0.9.3&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">near-sdk = &quot;4.0.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">futures = { version = &quot;0.3.21&quot;, default-features = false }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">async-std = &quot;1.12.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">hex = &quot;*&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">toml = &quot;0.5.9&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">atomic_refcell = &quot;0.1.8&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">bitvec = &quot;*&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">primitive-types = &quot;0.7.3&quot;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">near-jsonrpc-client = &quot;=0.4.0-beta.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">near-crypto = &quot;0.14.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">near-primitives = &quot;0.14.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">near-chain-configs = &quot;0.14.0&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">near-jsonrpc-primitives = &quot;0.14.0&quot;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">prometheus = { version = &quot;0.9&quot;, features = [</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">&quot;process&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">] }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">lazy_static = &quot;1.4&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">warp = &quot;0.2&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">thread = &quot;*&quot;</span></span></code></pre></div></div>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/eth2near/eth2near-block-relay" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">eth2near-block-relay</a> is built using javascript and supports ETH 1.0 Proof of Work (<code class="vocs_Code">ethhash</code>) using merkle patrica trees.</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph">key classes from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay/index.js" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">index.js</a> include</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">Ethashproof</code> : which has functions to <code class="vocs_Code">getParseBlock</code> and <code class="vocs_Code">calculateNextEpoch</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">Eth2NearRelay</code> : which interacts with the <code class="vocs_Code">ethClientContract</code> and has a <code class="vocs_Code">run()</code> function which loops through relaying blocks and includes additional functions such as <code class="vocs_Code">getParseBlock</code> , <code class="vocs_Code">submitBlock</code></li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Dependencies include (from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay/package.json" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">package.json</a>)</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&quot;dependencies&quot;: {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    &quot;bn.js&quot;: &quot;^5.1.3&quot;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    &quot;eth-object&quot;: &quot;https://github.com/near/eth-object#383b6ea68c7050bea4cab6950c1d5a7fa553e72b&quot;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    &quot;eth-util-lite&quot;: &quot;near/eth-util-lite#master&quot;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    &quot;@ethereumjs/block&quot;: &quot;^3.4.0&quot;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    &quot;merkle-patricia-tree&quot;: &quot;^2.1.2&quot;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    &quot;prom-client&quot;: &quot;^12.0.0&quot;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    &quot;promisfy&quot;: &quot;^1.2.0&quot;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    &quot;rainbow-bridge-utils&quot;: &quot;1.0.0&quot;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    &quot;got&quot;: &quot;^11.8.5&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">},</span></span></code></pre></div></div>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/eth2near/ethashproof" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ethhashproof</a>: is a commandline to calculate proof data for an ethash POW, it is used by project <code class="vocs_Code">SmartPool</code> and a decentralizedbridge between Etherum and EOS developed by Kyber Network team. It is written in <code class="vocs_Code">GO</code>.</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Features Include 1. Calculate merkle root of the ethash dag dataset with given epoch 2. Calculate merkle proof of the pow (dataset elements and their merkle proofs) given the pow submission with given block header 3. Generate dag datase</p>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Dependencies include (from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/ethashproof/go.mod" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ethahsproof/go.mod</a>)</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">require (</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> github.com/deckarep/golang-set v1.7.1</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    github.com/edsrzf/mmap-go v1.0.0</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    github.com/ethereum/go-ethereum v1.10.4</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    github.com/hashicorp/golang-lru v0.5.5-0.20210104140557-80c98217689d</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    golang.org/x/crypto v0.0.0-20210322153248-0c34fe9e7dc2</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span></code></pre></div></div>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/eth2near/finality-update-verify" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">finality-update-verify</a> checks and updates finality using the lighthouse beacon blocks.</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Functions include (from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/finality-update-verify/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">lib.rs</a>)</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">fn h256_to_hash256(hash: H256) -&gt; Hash256</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn tree_hash_h256_to_eth_type_h256(hash: tree_hash::Hash256) -&gt; eth_types::H256</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">fn to_lighthouse_beacon_block_header(bridge_beacon_block_header: &amp;BeaconBlockHeader,) -&gt; types::BeaconBlockHeader {types::BeaconBlockHeader</code></li>
<li class="vocs_ListItem"><code class="vocs_Code">pub fn is_correct_finality_update(ethereum_network: &amp;str, light_client_update: &amp;LightClientUpdate, sync_committee: SyncCommittee, ) -&gt; Result&lt;bool, Box&lt;dyn Error&gt;&gt;</code></li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Dependencies include (from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/finality-update-verify/Cargo.toml" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">finality-update-verify/Cargo.toml</a>)</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">dependencies</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    eth-types = { path =&quot;../../contracts/near/eth-types/&quot;, features = [</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">&quot;eip1559&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]}</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    bls = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    eth2-utility  = { path =&quot;../../contracts/near/eth2-utility&quot;}</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    tree_hash = { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    types =  { git = &quot;https://github.com/aurora-is-near/lighthouse.git&quot;, rev = &quot;b624c3f0d3c5bc9ea46faa14c9cb2d90ee1e1dec&quot; }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    bitvec = &quot;1.0.0&quot;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    [</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">dev-dependencies</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    eth2_to_near_relay = { path = &quot;../eth2near-block-relay-rs&quot;}</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    serde_json = &quot;1.0.74&quot;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    serde = { version = &quot;1.0&quot;, features = [</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">&quot;derive&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">] }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    toml = &quot;0.5.9&quot;</span></span></code></pre></div></div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="vocs_Paragraph">The following smart contracts are deployed on Ethereum and used for propogating blocks from NEAR to Ethereum.</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/eth" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Smart Contracts deployed on Ethereum</a> including<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/eth/nearbridge/contracts" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Near Bridge Contracts</a> including <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/NearBridge.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NearBridge.sol</a> which the interface <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/INearBridge.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">INearBridge.sol</a></p>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Interface Overview</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">interface INearBridge {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    event BlockHashAdded(uint64 indexed height, bytes32 blockHash);</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    event BlockHashReverted(uint64 indexed height, bytes32 blockHash);</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    function blockHashes(uint64 blockNumber) external view returns (bytes32);</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    function blockMerkleRoots(uint64 blockNumber) external view returns (bytes32);</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    function balanceOf(address wallet) external view returns (uint256);</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    function deposit() external payable;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    function withdraw() external;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    function initWithValidators(bytes calldata initialValidators) external;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    function initWithBlock(bytes calldata data) external;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    function addLightClientBlock(bytes calldata data) external;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    function challenge(address payable receiver, uint256 signatureIndex) external;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    function checkBlockProducerSignatureInHead(uint256 signatureIndex) external view returns (bool);</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Key Storage items for epoch and block information</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    Epoch[3] epochs;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    uint256 curEpoch;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    mapping(uint64 =&gt; bytes32) blockHashes_;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    mapping(uint64 =&gt; bytes32) blockMerkleRoots_;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    mapping(address =&gt; uint256) public override balanceOf;</span></span></code></pre></div></div>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Signing and Serializing Primitives</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/NearDecoder.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NearDecoder.sol</a>: handles decoing of Public Keys, Signatures, BlockProducers and LightClientBlocks using <code class="vocs_Code">Borsh.sol</code></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/Utils.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Utils.sol</a>: handles reading and writing to memory, memoryToBytes and has functions such as <code class="vocs_Code">keccak256Raw</code> and <code class="vocs_Code">sha256Raw</code></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/Borsh.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Borsh.sol</a>: <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://borsh.io/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Borsh</a>: Binary Object Representation Serializer for Hashing. It is meant to be used in security-critical projects as it prioritizes consistency, safety, speed; and comes with a strict specification.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/Ed25519.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Ed25519.sol</a>: <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://ed25519.cr.yp.to/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Ed25519</a> high-speed high-security signatures</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/contracts/eth/nearprover/contracts" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Near Prover Contracts</a></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearprover/contracts/NearProver.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NearProver.sol</a>: Has a <code class="vocs_Code">proveOutcome</code> which validates the outcome merkle proof and the block proof is valid using <code class="vocs_Code">_computeRoot</code> which is passed in a <code class="vocs_Code">bytes32 node, ProofDecoder.MerklePath memory proof</code></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearprover/contracts/ProofDecoder.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ProofDecoder.sol</a>: Uses MerklePaths to provide decoding functions such as <code class="vocs_Code">decodeExecutionStatus</code>, <code class="vocs_Code">decodeExecutionOutcome</code>, <code class="vocs_Code">decodeExecutionOutcomeWithId</code>, <code class="vocs_Code">decodeMerklePathItem</code>, <code class="vocs_Code">decodeMerklePath</code> and <code class="vocs_Code">decodeExecutionOutcomeWithIdAndProof</code>. It relies on the primitives <code class="vocs_Code">Borsh.sol</code> and <code class="vocs_Code">NearDecoder.sol</code> above.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="appendix-j---ethereum-to-near-walkthrough" class="vocs_Heading_slugTarget"></div>Appendix J - Ethereum to NEAR Walkthrough<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#appendix-j---ethereum-to-near-walkthrough" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Following is a walkthough of a funds transfer from Ethereum to a target chain (In this example Near), complete with light client updates, block propogation and proofs to ensure the transaction validity.</p>
<p class="vocs_Paragraph"><img src="/assets/posts/2023-02-05-ethereum-bridging-costs/eth2NearFundsTransfer.jpg" alt="Ethereum to Near Funds Transfer" title="Ethereum to NEAR Funds Transfer"/></p>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Actors</strong>
From the diagram above you&#x27;ll notice that there are many actors involved, below is an overview of the actors and the operations they perform.</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Accounts<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://etherscan.io/address/0x29da2ef94deeaf2d2f9003e9354abfcb1ff04b32" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">User Account</a> : The user is the owner of the funds being transferred and is responsible for signing the transactions to authorize bridging them accross chains. In this example they have accounts on <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://etherscan.io/address/0x29da2ef94deeaf2d2f9003e9354abfcb1ff04b32" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Ethereum</a> and <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/johnrubini.near#tokentxns" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NEAR</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/relayer.bridge.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Target Chain Relayer Acccount</a>: The relayer account is responsible for relaying messages from Ethereum to the target chain. *Note this is connected to a relayer which is responsible for tasks such as querying latest block headers and getting light client status updates. Source code is <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/tree/master/eth2near/eth2near-block-relay-rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a>.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/bridge-validator1.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Target Chain Bridge Validator Accounts</a>: are responsible for validating light client update proposals and sending approval votes to <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/bridge-validator.sputnik-dao.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">DAO Eth Client Contract</a>.</li>
</ul>
</li>
<li class="vocs_ListItem">Ethereum Components<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://etherscan.io/address/0xdac17f958d2ee523a2206206994597c13d831ec7#code" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ERC20 Token Contract</a>: this is the token contract securing the funds in this examle USDT (Tether). Source code is <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/release-v4.8/contracts/token/ERC20/presets/ERC20PresetMinterPauser.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://etherscan.io/address/0x23ddd3e3692d1861ed57ede224608875809e127f#code" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Bridge Contract</a>: Responsible for deposits and withdrawals of tokens on Ethereum as well as various proving and propogation mechanisms such as checking of Signatures and adding Light Client Blocks. Source code is <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/eth/nearbridge/contracts/NearBridge.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a></li>
</ul>
</li>
<li class="vocs_ListItem">Target Chain (NEAR) Components<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/bridge-validator.sputnik-dao.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Validator DAO Contract</a>: Responsible for receivng light client update proposals from the relayer and gathering approval votes for these propoals from Validators and submitting light client updates once the proposal is approved by the Validators. Source code is <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/contract_wrapper/src/dao_eth_client_contract.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/client-eth2.bridge.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Etherum 2 Client</a>: The Ethereum 2 client is responsbile for processing light client updates and receiving execution header blocks from Ethereum via the relayer. Source code is <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth2-client/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a>. <em>Note: this replaced the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/client.bridge.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Ethereum 1 client</a> source code <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth-client/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a></em></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/prover.bridge.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Ethereum Prover</a> : The Ethereum Prover is used to prove transactions are included in a valid block Header. Source code is <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth-prover/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/factory.bridge.near#contract" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Bridge Contract</a>: The Bridge contract is responsible for managing tokens including creating new tokens, setting metadata and depositing and withdrawal of tokens. Source code is <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-token-connector/blob/master/bridge-token-factory/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a>.<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/token/dac17f958d2ee523a2206206994597c13d831ec7.factory.bridge.near?a=dac17f958d2ee523a2206206994597c13d831ec7.factory.bridge.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NEAR Token Contract</a>: The target chain representation of the token (USDT) managed by the target chain bridge contract.</li>
</ul>
</li>
</ul>
</li>
</ul>
<strong class="vocs_Strong">Sample TransactionFlow</strong>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Block Propogation<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Get the Latest Slot: The relayer loops polling Ethereum every 12 seconds to get the latest slot. It then checks if it is for a new epoch and if so (every 6 minutes) submits an execution header (with 32 blocks in it) and a light client update with the latest approved epochs and updated sync_comittee. Relayer source code for the loop is <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/eth2near_relay.rs#L258" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a> for retrieving the latest slot is <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/eth2near_relay.rs#L163" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a>, for submitting execution blocks is <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/eth2near_relay.rs#L399" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a> and for sending light client updates is <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/eth2near-block-relay-rs/src/eth2near_relay.rs#L489" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">here</a>.<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/txns/HaXUxCvA1D87QXJzPzSYXmFYNuSLbTmyuxShzWgSLvPM" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Send Block Headers (submit_execution_header)</a>: Batch transaction which submits 32 block headers to <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/client-eth2.bridge.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">client-eth2.bridge.near</a> for Ethereum Blocks 16493592 to 16493623. (The second slot in epoch <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://beaconcha.in/epoch/176936" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">176,936</a> to the first slot in epoch <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://beaconcha.in/epoch/176937" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">176,937</a>). <strong class="vocs_Strong">Executed every 6 minutes when the first slot of a new epoch is found.</strong></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/txns/J1tQ465Dxt4UhWy9Msn2pZCbdkWatSepqsx9sDZaX35z#" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Create Light Client update proposal(add_proposal)</a>: calls <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/bridge-validator.sputnik-dao.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">bridge-validator.sputnik-dao.near</a> to add proposal 17410 for <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://beaconcha.in/slot/5661984" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">slot 5,661,984</a> in epoch <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://beaconcha.in/epoch/176937" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">176,937</a>.</li>
</ol>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/txns/D5uP4BbRSUX4ZGijRfWGkR5KbFb2Kb9q1gSsFVQbYSLt" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Approve Proposal (act_proposal)</a>: sends a VoteApprove action for proposal 17410 from a <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/bridge-validator1.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">bridge validator</a> to the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/bridge-validator.sputnik-dao.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Validator DAO Contract</a>.<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">act_proposal in contract <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/bridge-validator.sputnik-dao.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">bridge-validator.sputnik-dao.near</a></li>
<li class="vocs_ListItem">submit_beacon_chain_light_client_update in <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/client-eth2.bridge.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">client-eth2.bridge.near</a></li>
<li class="vocs_ListItem">on_proposal_callback in contract <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/bridge-validator.sputnik-dao.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">bridge-validator.sputnik-dao.near</a></li>
</ol>
</li>
</ol>
</li>
<li class="vocs_ListItem">Funds Transfer Transaction Flow<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://etherscan.io/tx/0xa685c59a24cc2056e10e660ce8a8bff7bbc335433698e138c77aaadf20ecb614" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Lock Funds On Ethereum</a>: Locking 10,000 USDT to send to user on NEAR.</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/txns/vniyRR67ndrtvpoQ9c5ACoT4e9c283VSQsrZcN6GGto#execution" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Deposit Funds on Target Chain Bridge Contract (deposit)</a>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">deposit in contract factory.bridge.near</li>
<li class="vocs_ListItem">verify_log_entry in contract prover.bridge.near</li>
<li class="vocs_ListItem">block_hash_safe in contract client-eth2.bridge.near</li>
<li class="vocs_ListItem">finish_deposit in contract factory.bridge.near : mint of 10,000 USDT.</li>
</ol>
</li>
</ol>
</li>
</ol>
<strong class="vocs_Strong">TODO</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Find and review the source code for the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/txns/HnzBR7x5Sxnmcm4MfRt1ghhMjJNspDaygUUKeM9T27Li#execution" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">validator light client approval update</a>. <em>Note: the eth2_client has a <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth2-client/src/lib.rs#L311" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">validate_light_client_update</a> which is <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth2-client/src/lib.rs#L42" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">configurable</a> and is used for debugging purposes.</em></li>
</ul>
<strong class="vocs_Strong">Bridging Resources Required</strong>
<p class="vocs_Paragraph">Here is the storage and compuational costs per component.</p>
<table class="vocs_Table"><thead><tr class="vocs_TableRow"><th class="vocs_TableHeader">Component</th><th class="vocs_TableHeader">Data</th><th class="vocs_TableHeader">Storage</th><th class="vocs_TableHeader">Notes</th></tr></thead><tbody><tr class="vocs_TableRow"><td class="vocs_TableCell"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth2-client/src/lib.rs#L35" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Ethereum 2 Client</a></td><td class="vocs_TableCell">---</td><td class="vocs_TableCell">---</td><td class="vocs_TableCell">---</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/contracts/near/eth-prover/src/lib.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Prover</a></td><td class="vocs_TableCell">not applicable</td><td class="vocs_TableCell">0 bytes</td><td class="vocs_TableCell"></td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/aurora-is-near/rainbow-bridge/blob/master/eth2near/contract_wrapper/src/dao_contract.rs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">DAO Contract</a></td><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td></tr></tbody></table>
<p class="vocs_Paragraph"><strong class="vocs_Strong">TODO</strong>
Review the following data structure and elements and move into the table above commenting on any mandatory requirements and structures that can be improved.</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pub struct Eth2Client {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// If set, only light client updates by the trusted signer will be accepted</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    trusted_signer: Option&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">AccountId</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Mask determining all paused functions</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    paused: Mask,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Whether the client validates the updates.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Should only be set to </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">`false`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> for debugging, testing, and diagnostic purposes</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    validate_updates: bool,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Whether the client verifies BLS signatures.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    verify_bls_signatures: bool,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// We store the hashes of the blocks for the past </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">`hashes_gc_threshold`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> headers.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Events that happen past this threshold cannot be verified by the client.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// It is desirable that this number is larger than 7 days&#x27; worth of headers, which is roughly</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// 51k Ethereum blocks. So this number should be 51k in production.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    hashes_gc_threshold: u64,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Network. e.g. mainnet, kiln</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    network: Network,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Hashes of the finalized execution blocks mapped to their numbers. Stores up to </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">`hashes_gc_threshold`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> entries.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Execution block number -&gt; execution block hash</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    finalized_execution_blocks: LookupMap&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">u64,</span><span style="color:#6F42C1;--shiki-dark:#6CB6FF" class="vocs_Span"> H256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// All unfinalized execution blocks&#x27; headers hashes mapped to their </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">`HeaderInfo`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Execution block hash -&gt; ExecutionHeaderInfo object</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    unfinalized_headers: UnorderedMap&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">H256,</span><span style="color:#6F42C1;--shiki-dark:#6CB6FF" class="vocs_Span"> ExecutionHeaderInfo</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">`AccountId`</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">s mapped to their number of submitted headers.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Submitter account -&gt; Num of submitted headers</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    submitters: LookupMap&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">AccountId,</span><span style="color:#6F42C1;--shiki-dark:#6CB6FF" class="vocs_Span"> u32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Max number of unfinalized blocks allowed to be stored by one submitter account</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// This value should be at least 32 blocks (1 epoch), but the recommended value is 1024 (32 epochs)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    max_submitted_blocks_by_account: u32,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    // The minimum balance that should be attached to register a new submitter account</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    min_storage_balance_for_submitter: Balance,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    /// Light client state</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    finalized_beacon_header: ExtendedBeaconBlockHeader,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    finalized_execution_header: LazyOption&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">ExecutionHeaderInfo</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    current_sync_committee: LazyOption&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">SyncCommittee</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    next_sync_committee: LazyOption&lt;</span><span style="color:#22863A;--shiki-dark:#8DDB8C" class="vocs_Span">SyncCommittee</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="appendix-k---explorer-and-interactive-links" class="vocs_Heading_slugTarget"></div>Appendix K - Explorer and Interactive Links<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/bridge/near-rainbow#appendix-k---explorer-and-interactive-links" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Near</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">eth-prover<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/relayer.bridge.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">https://nearblocks.io/address/relayer.bridge.near</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/client-eth2.bridge.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">https://nearblocks.io/address/client-eth2.bridge.near</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/client.bridge.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">https://nearblocks.io/address/client.bridge.near</a></li>
</ul>
</li>
<li class="vocs_ListItem">eth-client<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/prover.bridge.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">https://nearblocks.io/address/prover.bridge.near</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/client.bridge.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">https://nearblocks.io/address/client.bridge.near</a></li>
</ul>
</li>
<li class="vocs_ListItem">factory (manages tokens)<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/factory.bridge.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">https://nearblocks.io/address/factory.bridge.near</a></li>
</ul>
</li>
<li class="vocs_ListItem">dao<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/bridge-validator.sputnik-dao.near" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">https://nearblocks.io/address/bridge-validator.sputnik-dao.near</a></li>
</ul>
</li>
<li class="vocs_ListItem">aurora<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/aurora" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">https://nearblocks.io/address/aurora</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://nearblocks.io/address/relay.aurora" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">https://nearblocks.io/address/relay.aurora</a></li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Ethereum</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://beaconcha.in/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">beaconcha.in</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://beaconcha.in/validators" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">validators</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://beaconcha.in/epochs" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">epochs</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://beaconcha.in/slots" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">slots</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://beaconcha.in/blocks" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">blocks</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://beaconcha.in/transactions" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">transactions</a></li>
</ul>
</li>
<li class="vocs_ListItem">Near Bridge<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://etherscan.io/address/0x3fefc5a4b1c02f21cbc8d3613643ba0635b9a873" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">NearBridge</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://etherscan.io/tx/0xa685c59a24cc2056e10e660ce8a8bff7bbc335433698e138c77aaadf20ecb614" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ERC20Locker</a></li>
</ul>
</li>
</ul>
</li>
</ul></article><footer class="vocs_Footer" data-layout="docs"><div class="vocs_Footer_container"></div><div><center><p><a href="https://meet.johnwhitton.com">Meet with John</a></p><p class="copyright">John Whitton.<!-- --> <a href="mailto:john@johnwhitton.com">john@johnwhitton.com</a></p><p class="copyright">© John Whitton. Design:<!-- --> <a href="https://html5up.net">HTML5 UP</a>.</p></center></div></footer></div><div data-bottom-observer="true"></div></div></div>
  </body>
</html>
